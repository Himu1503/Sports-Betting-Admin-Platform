2025-10-31 13:28:25 - root - INFO - Logging configured - Level: INFO
2025-10-31 13:28:25 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 13:28:25 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform
2025-10-31 13:28:25 - database - ERROR - Failed to create database connection pool: [Errno 61] Connection refused - Host: localhost, Port: 5432, Database: analyst_platform
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 50, in create_pool
    _pool = await asyncpg.create_pool(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/pool.py", line 403, in _async__init__
    await self._initialize()
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/pool.py", line 430, in _initialize
    await first_ch.connect()
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/pool.py", line 128, in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/pool.py", line 502, in _get_new_connection
    con = await connection.connect(
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 2329, in connect
    return await connect_utils._connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connect_utils.py", line 1017, in _connect
    raise last_error or exceptions.TargetServerAttributeNotMatched(
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connect_utils.py", line 991, in _connect
    conn = await _connect_addr(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connect_utils.py", line 828, in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connect_utils.py", line 873, in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connect_utils.py", line 744, in _create_ssl_connection
    tr, pr = await loop.create_connection(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 2043, in create_connection
  File "uvloop/loop.pyx", line 2020, in uvloop.loop.Loop.create_connection
ConnectionRefusedError: [Errno 61] Connection refused
2025-10-31 13:28:25 - main - ERROR - Failed to create database connection pool: [Errno 61] Connection refused
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/main.py", line 35, in lifespan
    await create_pool()
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 50, in create_pool
    _pool = await asyncpg.create_pool(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/pool.py", line 403, in _async__init__
    await self._initialize()
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/pool.py", line 430, in _initialize
    await first_ch.connect()
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/pool.py", line 128, in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/pool.py", line 502, in _get_new_connection
    con = await connection.connect(
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 2329, in connect
    return await connect_utils._connect(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connect_utils.py", line 1017, in _connect
    raise last_error or exceptions.TargetServerAttributeNotMatched(
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connect_utils.py", line 991, in _connect
    conn = await _connect_addr(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connect_utils.py", line 828, in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connect_utils.py", line 873, in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connect_utils.py", line 744, in _create_ssl_connection
    tr, pr = await loop.create_connection(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "uvloop/loop.pyx", line 2043, in create_connection
  File "uvloop/loop.pyx", line 2020, in uvloop.loop.Loop.create_connection
ConnectionRefusedError: [Errno 61] Connection refused
2025-10-31 14:01:49 - root - INFO - Logging configured - Level: INFO
2025-10-31 14:02:09 - root - INFO - Logging configured - Level: INFO
2025-10-31 14:02:25 - root - INFO - Logging configured - Level: INFO
2025-10-31 14:02:54 - root - INFO - Logging configured - Level: INFO
2025-10-31 14:03:09 - root - INFO - Logging configured - Level: INFO
2025-10-31 14:03:32 - root - INFO - Logging configured - Level: INFO
2025-10-31 14:03:32 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:03:32 - database - INFO - Database connection pool created successfully
2025-10-31 14:03:32 - httpx - INFO - HTTP Request: GET http://test/ "HTTP/1.1 200 OK"
2025-10-31 14:04:00 - root - INFO - Logging configured - Level: INFO
2025-10-31 14:04:00 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:00 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:00 - database - ERROR - Database insert error: relation "sports" does not exist - Query: INSERT INTO sports (name) VALUES ($1) RETURNING name
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 121, in execute_insert
    result = await conn.fetchval(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 715, in fetchval
    data = await self._execute(query, args, 1, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "sports" does not exist
2025-10-31 14:04:00 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 400 Bad Request"
2025-10-31 14:04:00 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:01 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:01 - database - ERROR - Database insert error: relation "sports" does not exist - Query: INSERT INTO sports (name) VALUES ($1) RETURNING name
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 121, in execute_insert
    result = await conn.fetchval(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 715, in fetchval
    data = await self._execute(query, args, 1, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "sports" does not exist
2025-10-31 14:04:01 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 400 Bad Request"
2025-10-31 14:04:01 - database - ERROR - Database query error: relation "audit_log" does not exist - Query: 
        SELECT id, table_name, operation, username, changed_at, row_id, old_data, new_data
        
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "audit_log" does not exist
2025-10-31 14:04:01 - main - ERROR - Unhandled exception: relation "audit_log" does not exist - Path: /api/audit - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/audit.py", line 45, in get_audit_logs
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "audit_log" does not exist
2025-10-31 14:04:01 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:01 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:01 - database - ERROR - Database insert error: relation "sports" does not exist - Query: INSERT INTO sports (name) VALUES ($1) RETURNING name
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 121, in execute_insert
    result = await conn.fetchval(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 715, in fetchval
    data = await self._execute(query, args, 1, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "sports" does not exist
2025-10-31 14:04:01 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 400 Bad Request"
2025-10-31 14:04:01 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:01 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:01 - database - ERROR - Database query error: relation "bets" does not exist - Query: 
        SELECT 
            id, bookie, customer_id, bookie_bet_id, bet_type, event_id, sport,
    
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "bets" does not exist
2025-10-31 14:04:01 - main - ERROR - Unhandled exception: relation "bets" does not exist - Path: /api/bets - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/bets.py", line 67, in get_bets
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "bets" does not exist
2025-10-31 14:04:01 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:01 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:01 - database - ERROR - Database query error: relation "teams" does not exist - Query: SELECT id, name, country, sport, created_at, updated_at FROM teams WHERE 1=1 ORDER BY name LIMIT $1 
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:01 - main - ERROR - Unhandled exception: relation "teams" does not exist - Path: /api/teams - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/teams.py", line 36, in get_teams
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:01 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:01 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:02 - database - ERROR - Database query error: relation "bets" does not exist - Query: 
        SELECT 
            id, bookie, customer_id, bookie_bet_id, bet_type, event_id, sport,
    
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "bets" does not exist
2025-10-31 14:04:02 - main - ERROR - Unhandled exception: relation "bets" does not exist - Path: /api/bets - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/bets.py", line 67, in get_bets
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "bets" does not exist
2025-10-31 14:04:02 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:02 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:02 - database - ERROR - Database query error: relation "customers" does not exist - Query: 
        SELECT 
            id, username, password, real_name, currency, status,
            (balan
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "customers" does not exist
2025-10-31 14:04:02 - main - ERROR - Unhandled exception: relation "customers" does not exist - Path: /api/customers - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/customers.py", line 54, in get_customers
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "customers" does not exist
2025-10-31 14:04:02 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:02 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:02 - database - ERROR - Database query error: relation "bets" does not exist - Query: 
        SELECT 
            id, bookie, customer_id, bookie_bet_id, bet_type, event_id, sport,
    
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "bets" does not exist
2025-10-31 14:04:02 - main - ERROR - Unhandled exception: relation "bets" does not exist - Path: /api/bets - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/bets.py", line 67, in get_bets
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "bets" does not exist
2025-10-31 14:04:02 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:02 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:02 - database - ERROR - Database query error: relation "bets" does not exist - Query: 
        SELECT 
            id, bookie, customer_id, bookie_bet_id, bet_type, event_id, sport,
    
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "bets" does not exist
2025-10-31 14:04:02 - main - ERROR - Unhandled exception: relation "bets" does not exist - Path: /api/bets - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/bets.py", line 67, in get_bets
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "bets" does not exist
2025-10-31 14:04:03 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:03 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:03 - database - ERROR - Database query error: relation "customers" does not exist - Query: 
        SELECT 
            id, username, password, real_name, currency, status,
            (balan
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "customers" does not exist
2025-10-31 14:04:03 - main - ERROR - Unhandled exception: relation "customers" does not exist - Path: /api/customers - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/customers.py", line 54, in get_customers
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "customers" does not exist
2025-10-31 14:04:03 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:03 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:03 - database - ERROR - Database query error: relation "customers" does not exist - Query: 
            INSERT INTO customers (username, password, real_name, currency, status, balance, prefer
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "customers" does not exist
2025-10-31 14:04:03 - routers.customers - ERROR - Error creating customer - Username: new_customer, Error: relation "customers" does not exist
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/routers/customers.py", line 120, in create_customer
    result = await execute_one(
             ^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "customers" does not exist
2025-10-31 14:04:03 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 400 Bad Request"
2025-10-31 14:04:03 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:03 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:03 - database - ERROR - Database query error: relation "customers" does not exist - Query: 
            INSERT INTO customers (username, password, real_name, currency, status, balance, prefer
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "customers" does not exist
2025-10-31 14:04:03 - routers.customers - ERROR - Error creating customer - Username: duplicate_test, Error: relation "customers" does not exist
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/routers/customers.py", line 120, in create_customer
    result = await execute_one(
             ^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "customers" does not exist
2025-10-31 14:04:03 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 400 Bad Request"
2025-10-31 14:04:03 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:03 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:03 - database - ERROR - Database query error: relation "customers" does not exist - Query: 
            INSERT INTO customers (username, password, real_name, currency, status, balance, prefer
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "customers" does not exist
2025-10-31 14:04:03 - routers.customers - ERROR - Error creating customer - Username: get_test_customer, Error: relation "customers" does not exist
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/routers/customers.py", line 120, in create_customer
    result = await execute_one(
             ^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "customers" does not exist
2025-10-31 14:04:03 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 400 Bad Request"
2025-10-31 14:04:03 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:03 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:03 - database - ERROR - Database query error: relation "customers" does not exist - Query: 
            INSERT INTO customers (username, password, real_name, currency, status, balance, prefer
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "customers" does not exist
2025-10-31 14:04:03 - routers.customers - ERROR - Error creating customer - Username: update_test, Error: relation "customers" does not exist
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/routers/customers.py", line 120, in create_customer
    result = await execute_one(
             ^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "customers" does not exist
2025-10-31 14:04:03 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 400 Bad Request"
2025-10-31 14:04:03 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:03 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:03 - database - ERROR - Database query error: relation "customers" does not exist - Query: 
        SELECT 
            id, username, password, real_name, currency, status,
            (balan
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "customers" does not exist
2025-10-31 14:04:03 - main - ERROR - Unhandled exception: relation "customers" does not exist - Path: /api/customers - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/customers.py", line 54, in get_customers
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "customers" does not exist
2025-10-31 14:04:03 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:04 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:04 - database - ERROR - Database query error: relation "customers" does not exist - Query: 
            INSERT INTO customers (username, password, real_name, currency, status, balance, prefer
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "customers" does not exist
2025-10-31 14:04:04 - routers.customers - ERROR - Error creating customer - Username: delete_test, Error: relation "customers" does not exist
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/routers/customers.py", line 120, in create_customer
    result = await execute_one(
             ^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "customers" does not exist
2025-10-31 14:04:04 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 400 Bad Request"
2025-10-31 14:04:04 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:04 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:04 - database - ERROR - Database query error: relation "events" does not exist - Query: 
        SELECT id, date, competition_id, team_a_id, team_b_id, status, created_at, updated_at
     
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "events" does not exist
2025-10-31 14:04:04 - main - ERROR - Unhandled exception: relation "events" does not exist - Path: /api/events - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/events.py", line 40, in get_events
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "events" does not exist
2025-10-31 14:04:04 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:04 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:04 - database - ERROR - Database query error: relation "teams" does not exist - Query: SELECT id, name, country, sport, created_at, updated_at FROM teams WHERE 1=1 ORDER BY name LIMIT $1 
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:04 - main - ERROR - Unhandled exception: relation "teams" does not exist - Path: /api/teams - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/teams.py", line 36, in get_teams
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:04 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:04 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:04 - database - ERROR - Database query error: relation "teams" does not exist - Query: SELECT id, name, country, sport, created_at, updated_at FROM teams WHERE 1=1 ORDER BY name LIMIT $1 
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:04 - main - ERROR - Unhandled exception: relation "teams" does not exist - Path: /api/teams - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/teams.py", line 36, in get_teams
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:05 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:05 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:05 - database - ERROR - Database query error: relation "teams" does not exist - Query: SELECT id, name, country, sport, created_at, updated_at FROM teams WHERE 1=1 ORDER BY name LIMIT $1 
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:05 - main - ERROR - Unhandled exception: relation "teams" does not exist - Path: /api/teams - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/teams.py", line 36, in get_teams
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:05 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:05 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:05 - database - ERROR - Database query error: relation "teams" does not exist - Query: SELECT id, name, country, sport, created_at, updated_at FROM teams WHERE 1=1 ORDER BY name LIMIT $1 
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:05 - main - ERROR - Unhandled exception: relation "teams" does not exist - Path: /api/teams - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/teams.py", line 36, in get_teams
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:05 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:05 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:05 - database - ERROR - Database query error: relation "teams" does not exist - Query: SELECT id, name, country, sport, created_at, updated_at FROM teams WHERE 1=1 ORDER BY name LIMIT $1 
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:05 - main - ERROR - Unhandled exception: relation "teams" does not exist - Path: /api/teams - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/teams.py", line 36, in get_teams
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:05 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:05 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:05 - httpx - INFO - HTTP Request: GET http://test/ "HTTP/1.1 200 OK"
2025-10-31 14:04:05 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:06 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:06 - httpx - INFO - HTTP Request: GET http://test/health "HTTP/1.1 200 OK"
2025-10-31 14:04:06 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:06 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:06 - database - ERROR - Database query error: relation "sports" does not exist - Query: SELECT name FROM sports ORDER BY name
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "sports" does not exist
2025-10-31 14:04:06 - main - ERROR - Unhandled exception: relation "sports" does not exist - Path: /api/sports - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/sports.py", line 14, in get_sports
    results = await execute_query(query)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "sports" does not exist
2025-10-31 14:04:06 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:06 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:06 - database - ERROR - Database insert error: relation "sports" does not exist - Query: INSERT INTO sports (name) VALUES ($1) RETURNING name
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 121, in execute_insert
    result = await conn.fetchval(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 715, in fetchval
    data = await self._execute(query, args, 1, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "sports" does not exist
2025-10-31 14:04:06 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 400 Bad Request"
2025-10-31 14:04:06 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:06 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:06 - database - ERROR - Database insert error: relation "sports" does not exist - Query: INSERT INTO sports (name) VALUES ($1) RETURNING name
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 121, in execute_insert
    result = await conn.fetchval(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 715, in fetchval
    data = await self._execute(query, args, 1, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "sports" does not exist
2025-10-31 14:04:06 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 400 Bad Request"
2025-10-31 14:04:06 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:06 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:06 - database - ERROR - Database insert error: relation "sports" does not exist - Query: INSERT INTO sports (name) VALUES ($1) RETURNING name
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 121, in execute_insert
    result = await conn.fetchval(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 715, in fetchval
    data = await self._execute(query, args, 1, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "sports" does not exist
2025-10-31 14:04:06 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 400 Bad Request"
2025-10-31 14:04:06 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:06 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:06 - database - ERROR - Database insert error: relation "sports" does not exist - Query: INSERT INTO sports (name) VALUES ($1) RETURNING name
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 121, in execute_insert
    result = await conn.fetchval(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 715, in fetchval
    data = await self._execute(query, args, 1, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "sports" does not exist
2025-10-31 14:04:06 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 400 Bad Request"
2025-10-31 14:04:06 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:06 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:06 - database - ERROR - Database update/delete error: relation "sports" does not exist - Query: DELETE FROM sports WHERE name = $1
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "sports" does not exist
2025-10-31 14:04:06 - main - ERROR - Unhandled exception: relation "sports" does not exist - Path: /api/sports/NonexistentSport - Method: DELETE
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/sports.py", line 54, in delete_sport
    affected = await execute_update(query, name)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "sports" does not exist
2025-10-31 14:04:06 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:07 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:07 - database - ERROR - Database query error: relation "sports" does not exist - Query: SELECT name FROM sports WHERE name = $1
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "sports" does not exist
2025-10-31 14:04:07 - main - ERROR - Unhandled exception: relation "sports" does not exist - Path: /api/sports/NonexistentSport - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/sports.py", line 22, in get_sport
    result = await execute_one(query, name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "sports" does not exist
2025-10-31 14:04:07 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:07 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:07 - database - ERROR - Database query error: relation "teams" does not exist - Query: SELECT id, name, country, sport, created_at, updated_at FROM teams WHERE 1=1 ORDER BY name LIMIT $1 
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:07 - main - ERROR - Unhandled exception: relation "teams" does not exist - Path: /api/teams - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/teams.py", line 36, in get_teams
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:07 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:07 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:07 - database - ERROR - Database query error: relation "teams" does not exist - Query: SELECT id, name, country, sport, created_at, updated_at FROM teams WHERE 1=1 AND sport = $1 ORDER BY
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:07 - main - ERROR - Unhandled exception: relation "teams" does not exist - Path: /api/teams - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/teams.py", line 36, in get_teams
    results = await execute_query(query, *params)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 97, in execute_query
    rows = await conn.fetch(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 691, in fetch
    return await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:07 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:07 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:07 - database - ERROR - Database query error: relation "teams" does not exist - Query: 
            INSERT INTO teams (name, country, sport)
            VALUES ($1, $2, $3)
            RE
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:07 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 400 Bad Request"
2025-10-31 14:04:07 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:07 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:08 - database - ERROR - Database query error: relation "teams" does not exist - Query: 
            INSERT INTO teams (name, country, sport)
            VALUES ($1, $2, $3)
            RE
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:08 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 400 Bad Request"
2025-10-31 14:04:08 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:08 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:08 - database - ERROR - Database query error: relation "teams" does not exist - Query: 
            INSERT INTO teams (name, country, sport)
            VALUES ($1, $2, $3)
            RE
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:08 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 400 Bad Request"
2025-10-31 14:04:08 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:08 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:08 - database - ERROR - Database query error: relation "teams" does not exist - Query: 
            INSERT INTO teams (name, country, sport)
            VALUES ($1, $2, $3)
            RE
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:08 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 400 Bad Request"
2025-10-31 14:04:08 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:04:08 - database - INFO - Database connection pool created successfully
2025-10-31 14:04:08 - database - ERROR - Database query error: relation "teams" does not exist - Query: 
            INSERT INTO teams (name, country, sport)
            VALUES ($1, $2, $3)
            RE
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1933, in _do_execute
    stmt = await self._get_statement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 433, in _get_statement
    statement = await self._protocol.prepare(
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 166, in prepare
asyncpg.exceptions.UndefinedTableError: relation "teams" does not exist
2025-10-31 14:04:08 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 400 Bad Request"
2025-10-31 14:15:32 - root - INFO - Logging configured - Level: INFO
2025-10-31 14:15:32 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:15:33 - database - INFO - Database connection pool created successfully
2025-10-31 14:15:33 - httpx - INFO - HTTP Request: GET http://test/api/sports "HTTP/1.1 200 OK"
2025-10-31 14:15:50 - root - INFO - Logging configured - Level: INFO
2025-10-31 14:15:51 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:15:51 - database - INFO - Database connection pool created successfully
2025-10-31 14:15:51 - httpx - INFO - HTTP Request: GET http://test/api/sports "HTTP/1.1 200 OK"
2025-10-31 14:15:51 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:15:51 - database - INFO - Database connection pool created successfully
2025-10-31 14:15:51 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:15:51 - httpx - INFO - HTTP Request: GET http://test/api/sports/Tennis "HTTP/1.1 200 OK"
2025-10-31 14:15:51 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:15:51 - database - INFO - Database connection pool created successfully
2025-10-31 14:15:51 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:15:51 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:15:51 - database - INFO - Database connection pool created successfully
2025-10-31 14:15:51 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:15:51 - database - ERROR - Database insert error: duplicate key value violates unique constraint "sports_pkey"
DETAIL:  Key (name)=(Rugby) already exists. - Query: INSERT INTO sports (name) VALUES ($1) RETURNING name
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 121, in execute_insert
    result = await conn.fetchval(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 715, in fetchval
    data = await self._execute(query, args, 1, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "sports_pkey"
DETAIL:  Key (name)=(Rugby) already exists.
2025-10-31 14:15:51 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 409 Conflict"
2025-10-31 14:15:51 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:15:51 - database - INFO - Database connection pool created successfully
2025-10-31 14:15:51 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:15:51 - httpx - INFO - HTTP Request: DELETE http://test/api/sports/Cricket "HTTP/1.1 204 No Content"
2025-10-31 14:15:51 - httpx - INFO - HTTP Request: GET http://test/api/sports/Cricket "HTTP/1.1 404 Not Found"
2025-10-31 14:15:52 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:15:52 - database - INFO - Database connection pool created successfully
2025-10-31 14:15:52 - httpx - INFO - HTTP Request: DELETE http://test/api/sports/NonexistentSport "HTTP/1.1 404 Not Found"
2025-10-31 14:15:52 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:15:52 - database - INFO - Database connection pool created successfully
2025-10-31 14:15:52 - httpx - INFO - HTTP Request: GET http://test/api/sports/NonexistentSport "HTTP/1.1 404 Not Found"
2025-10-31 14:15:55 - root - INFO - Logging configured - Level: INFO
2025-10-31 14:15:55 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:15:55 - database - INFO - Database connection pool created successfully
2025-10-31 14:15:55 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 14:16:06 - root - INFO - Logging configured - Level: INFO
2025-10-31 14:16:06 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:06 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:06 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:06 - main - ERROR - Unhandled exception: 1 validation error for AuditLog
new_data
  Input should be a valid dictionary [type=dict_type, input_value='{"id": 1, "status": "act...00", "preferences": {}}', input_type=str]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type - Path: /api/audit - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/audit.py", line 46, in get_audit_logs
    return [AuditLog(**row) for row in results]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/audit.py", line 46, in <listcomp>
    return [AuditLog(**row) for row in results]
            ^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for AuditLog
new_data
  Input should be a valid dictionary [type=dict_type, input_value='{"id": 1, "status": "act...00", "preferences": {}}', input_type=str]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
2025-10-31 14:16:06 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:06 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:06 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:06 - httpx - INFO - HTTP Request: GET http://test/api/audit?table_name=sports "HTTP/1.1 200 OK"
2025-10-31 14:16:06 - main - ERROR - Unhandled exception: 1 validation error for AuditLog
new_data
  Input should be a valid dictionary [type=dict_type, input_value='{"id": 1, "status": "act...00", "preferences": {}}', input_type=str]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type - Path: /api/audit - Method: GET
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/audit.py", line 46, in get_audit_logs
    return [AuditLog(**row) for row in results]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/routers/audit.py", line 46, in <listcomp>
    return [AuditLog(**row) for row in results]
            ^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for AuditLog
new_data
  Input should be a valid dictionary [type=dict_type, input_value='{"id": 1, "status": "act...00", "preferences": {}}', input_type=str]
    For further information visit https://errors.pydantic.dev/2.5/v/dict_type
2025-10-31 14:16:07 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:07 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:07 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:07 - httpx - INFO - HTTP Request: GET http://test/api/audit?table_name=sports "HTTP/1.1 200 OK"
2025-10-31 14:16:07 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:07 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:07 - httpx - INFO - HTTP Request: GET http://test/api/bets "HTTP/1.1 200 OK"
2025-10-31 14:16:07 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:07 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:07 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:16:07 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:16:07 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 14:16:07 - httpx - INFO - HTTP Request: GET http://test/api/customers "HTTP/1.1 200 OK"
2025-10-31 14:16:07 - httpx - INFO - HTTP Request: POST http://test/api/bets "HTTP/1.1 201 Created"
2025-10-31 14:16:07 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:07 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:07 - httpx - INFO - HTTP Request: GET http://test/api/bets "HTTP/1.1 200 OK"
2025-10-31 14:16:07 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:07 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:07 - httpx - INFO - HTTP Request: GET http://test/api/customers "HTTP/1.1 200 OK"
2025-10-31 14:16:07 - httpx - INFO - HTTP Request: GET http://test/api/bets?customer_id=1 "HTTP/1.1 200 OK"
2025-10-31 14:16:07 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:08 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:08 - httpx - INFO - HTTP Request: GET http://test/api/bets "HTTP/1.1 200 OK"
2025-10-31 14:16:08 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:08 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:08 - httpx - INFO - HTTP Request: GET http://test/api/bets "HTTP/1.1 200 OK"
2025-10-31 14:16:08 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:08 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:08 - httpx - INFO - HTTP Request: GET http://test/api/customers "HTTP/1.1 200 OK"
2025-10-31 14:16:08 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:08 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:08 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 14:16:08 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:08 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:08 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 14:16:08 - database - ERROR - Database query error: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists. - Query: 
            INSERT INTO customers (username, password, real_name, currency, status, balance, prefer
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists.
2025-10-31 14:16:08 - routers.customers - ERROR - Error creating customer - Username: duplicate_test, Error: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists.
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/routers/customers.py", line 120, in create_customer
    result = await execute_one(
             ^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists.
2025-10-31 14:16:08 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 409 Conflict"
2025-10-31 14:16:08 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:08 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:08 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 14:16:08 - httpx - INFO - HTTP Request: GET http://test/api/customers/2 "HTTP/1.1 200 OK"
2025-10-31 14:16:09 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:09 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:09 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 14:16:09 - httpx - INFO - HTTP Request: PUT http://test/api/customers/2 "HTTP/1.1 200 OK"
2025-10-31 14:16:09 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:09 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:09 - httpx - INFO - HTTP Request: GET http://test/api/customers?status=active "HTTP/1.1 200 OK"
2025-10-31 14:16:09 - httpx - INFO - HTTP Request: GET http://test/api/customers?currency=USD "HTTP/1.1 200 OK"
2025-10-31 14:16:09 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:09 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:09 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 14:16:09 - httpx - INFO - HTTP Request: DELETE http://test/api/customers/2 "HTTP/1.1 204 No Content"
2025-10-31 14:16:09 - httpx - INFO - HTTP Request: GET http://test/api/customers/2 "HTTP/1.1 404 Not Found"
2025-10-31 14:16:09 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:09 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:09 - httpx - INFO - HTTP Request: GET http://test/api/events "HTTP/1.1 200 OK"
2025-10-31 14:16:09 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:09 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:09 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:16:09 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:16:09 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 14:16:09 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:09 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:09 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:16:09 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:16:09 - database - ERROR - Database query error: new row for relation "events" violates check constraint "different_teams"
DETAIL:  Failing row contains (1, 2025-11-01 14:16:09.972088+00, 1, 1, 1, prematch, 2025-10-31 14:16:09.977623+00, 2025-10-31 14:16:09.977623+00). - Query: 
            INSERT INTO events (date, competition_id, team_a_id, team_b_id, status)
            VAL
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.CheckViolationError: new row for relation "events" violates check constraint "different_teams"
DETAIL:  Failing row contains (1, 2025-11-01 14:16:09.972088+00, 1, 1, 1, prematch, 2025-10-31 14:16:09.977623+00, 2025-10-31 14:16:09.977623+00).
2025-10-31 14:16:09 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 400 Bad Request"
2025-10-31 14:16:10 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:10 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:10 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:16:10 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:16:10 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 14:16:10 - httpx - INFO - HTTP Request: GET http://test/api/events/1 "HTTP/1.1 200 OK"
2025-10-31 14:16:10 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:10 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:10 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:16:10 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:16:10 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 14:16:10 - httpx - INFO - HTTP Request: PUT http://test/api/events/1 "HTTP/1.1 200 OK"
2025-10-31 14:16:10 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:10 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:10 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:16:10 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:16:10 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 14:16:10 - httpx - INFO - HTTP Request: DELETE http://test/api/events/1 "HTTP/1.1 204 No Content"
2025-10-31 14:16:10 - httpx - INFO - HTTP Request: GET http://test/api/events/1 "HTTP/1.1 404 Not Found"
2025-10-31 14:16:10 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:10 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:10 - httpx - INFO - HTTP Request: GET http://test/ "HTTP/1.1 200 OK"
2025-10-31 14:16:10 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:10 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:10 - httpx - INFO - HTTP Request: GET http://test/health "HTTP/1.1 200 OK"
2025-10-31 14:16:10 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:10 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:10 - httpx - INFO - HTTP Request: GET http://test/api/sports "HTTP/1.1 200 OK"
2025-10-31 14:16:11 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:11 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:11 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:11 - httpx - INFO - HTTP Request: GET http://test/api/sports/Tennis "HTTP/1.1 200 OK"
2025-10-31 14:16:11 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:11 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:11 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:11 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:11 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:11 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:11 - database - ERROR - Database insert error: duplicate key value violates unique constraint "sports_pkey"
DETAIL:  Key (name)=(Rugby) already exists. - Query: INSERT INTO sports (name) VALUES ($1) RETURNING name
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 121, in execute_insert
    result = await conn.fetchval(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 715, in fetchval
    data = await self._execute(query, args, 1, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "sports_pkey"
DETAIL:  Key (name)=(Rugby) already exists.
2025-10-31 14:16:11 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 409 Conflict"
2025-10-31 14:16:11 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:11 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:11 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:11 - httpx - INFO - HTTP Request: DELETE http://test/api/sports/Cricket "HTTP/1.1 204 No Content"
2025-10-31 14:16:11 - httpx - INFO - HTTP Request: GET http://test/api/sports/Cricket "HTTP/1.1 404 Not Found"
2025-10-31 14:16:11 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:11 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:11 - httpx - INFO - HTTP Request: DELETE http://test/api/sports/NonexistentSport "HTTP/1.1 404 Not Found"
2025-10-31 14:16:11 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:11 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:11 - httpx - INFO - HTTP Request: GET http://test/api/sports/NonexistentSport "HTTP/1.1 404 Not Found"
2025-10-31 14:16:12 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:12 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:12 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:16:12 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:12 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:12 - httpx - INFO - HTTP Request: GET http://test/api/teams?sport=Football "HTTP/1.1 200 OK"
2025-10-31 14:16:12 - httpx - INFO - HTTP Request: GET http://test/api/teams?country=USA "HTTP/1.1 200 OK"
2025-10-31 14:16:12 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:12 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:12 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 14:16:12 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:12 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:12 - database - ERROR - Database query error: insert or update on table "teams" violates foreign key constraint "teams_sport_fkey"
DETAIL:  Key (sport)=(InvalidSport) is not present in table "sports". - Query: 
            INSERT INTO teams (name, country, sport)
            VALUES ($1, $2, $3)
            RE
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: insert or update on table "teams" violates foreign key constraint "teams_sport_fkey"
DETAIL:  Key (sport)=(InvalidSport) is not present in table "sports".
2025-10-31 14:16:12 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 400 Bad Request"
2025-10-31 14:16:12 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:12 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:12 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 14:16:12 - httpx - INFO - HTTP Request: GET http://test/api/teams/3 "HTTP/1.1 200 OK"
2025-10-31 14:16:12 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:12 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:12 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 14:16:12 - httpx - INFO - HTTP Request: PUT http://test/api/teams/3 "HTTP/1.1 200 OK"
2025-10-31 14:16:13 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:13 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:13 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 14:16:13 - httpx - INFO - HTTP Request: DELETE http://test/api/teams/3 "HTTP/1.1 204 No Content"
2025-10-31 14:16:13 - httpx - INFO - HTTP Request: GET http://test/api/teams/3 "HTTP/1.1 404 Not Found"
2025-10-31 14:16:44 - root - INFO - Logging configured - Level: INFO
2025-10-31 14:16:44 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:44 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:44 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:44 - httpx - INFO - HTTP Request: GET http://test/api/audit "HTTP/1.1 200 OK"
2025-10-31 14:16:44 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:44 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:44 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:44 - httpx - INFO - HTTP Request: GET http://test/api/audit?table_name=sports "HTTP/1.1 200 OK"
2025-10-31 14:16:44 - httpx - INFO - HTTP Request: GET http://test/api/audit?operation=INSERT "HTTP/1.1 200 OK"
2025-10-31 14:16:44 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:44 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:44 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:44 - httpx - INFO - HTTP Request: GET http://test/api/audit?table_name=sports "HTTP/1.1 200 OK"
2025-10-31 14:16:51 - root - INFO - Logging configured - Level: INFO
2025-10-31 14:16:52 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:52 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:52 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:52 - httpx - INFO - HTTP Request: GET http://test/api/audit "HTTP/1.1 200 OK"
2025-10-31 14:16:52 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:52 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:52 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:52 - httpx - INFO - HTTP Request: GET http://test/api/audit?table_name=sports "HTTP/1.1 200 OK"
2025-10-31 14:16:52 - httpx - INFO - HTTP Request: GET http://test/api/audit?operation=INSERT "HTTP/1.1 200 OK"
2025-10-31 14:16:52 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:52 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:52 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:52 - httpx - INFO - HTTP Request: GET http://test/api/audit?table_name=sports "HTTP/1.1 200 OK"
2025-10-31 14:16:52 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:52 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:52 - httpx - INFO - HTTP Request: GET http://test/api/bets "HTTP/1.1 200 OK"
2025-10-31 14:16:52 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:52 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:52 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:16:52 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:16:52 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 14:16:52 - httpx - INFO - HTTP Request: GET http://test/api/customers "HTTP/1.1 200 OK"
2025-10-31 14:16:52 - httpx - INFO - HTTP Request: POST http://test/api/bets "HTTP/1.1 201 Created"
2025-10-31 14:16:52 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:53 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:53 - httpx - INFO - HTTP Request: GET http://test/api/bets "HTTP/1.1 200 OK"
2025-10-31 14:16:53 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:53 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:53 - httpx - INFO - HTTP Request: GET http://test/api/customers "HTTP/1.1 200 OK"
2025-10-31 14:16:53 - httpx - INFO - HTTP Request: GET http://test/api/bets?customer_id=1 "HTTP/1.1 200 OK"
2025-10-31 14:16:53 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:53 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:53 - httpx - INFO - HTTP Request: GET http://test/api/bets "HTTP/1.1 200 OK"
2025-10-31 14:16:53 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:53 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:53 - httpx - INFO - HTTP Request: GET http://test/api/bets "HTTP/1.1 200 OK"
2025-10-31 14:16:53 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:53 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:53 - httpx - INFO - HTTP Request: GET http://test/api/customers "HTTP/1.1 200 OK"
2025-10-31 14:16:53 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:53 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:53 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 14:16:53 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:54 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:54 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 14:16:54 - database - ERROR - Database query error: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists. - Query: 
            INSERT INTO customers (username, password, real_name, currency, status, balance, prefer
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists.
2025-10-31 14:16:54 - routers.customers - ERROR - Error creating customer - Username: duplicate_test, Error: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists.
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/routers/customers.py", line 120, in create_customer
    result = await execute_one(
             ^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists.
2025-10-31 14:16:54 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 409 Conflict"
2025-10-31 14:16:54 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:54 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:54 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 14:16:54 - httpx - INFO - HTTP Request: GET http://test/api/customers/2 "HTTP/1.1 200 OK"
2025-10-31 14:16:54 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:54 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:54 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 14:16:54 - httpx - INFO - HTTP Request: PUT http://test/api/customers/2 "HTTP/1.1 200 OK"
2025-10-31 14:16:54 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:54 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:54 - httpx - INFO - HTTP Request: GET http://test/api/customers?status=active "HTTP/1.1 200 OK"
2025-10-31 14:16:54 - httpx - INFO - HTTP Request: GET http://test/api/customers?currency=USD "HTTP/1.1 200 OK"
2025-10-31 14:16:54 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:54 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:54 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 14:16:54 - httpx - INFO - HTTP Request: DELETE http://test/api/customers/2 "HTTP/1.1 204 No Content"
2025-10-31 14:16:54 - httpx - INFO - HTTP Request: GET http://test/api/customers/2 "HTTP/1.1 404 Not Found"
2025-10-31 14:16:54 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:54 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:54 - httpx - INFO - HTTP Request: GET http://test/api/events "HTTP/1.1 200 OK"
2025-10-31 14:16:54 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:55 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 14:16:55 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:55 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:16:55 - database - ERROR - Database query error: new row for relation "events" violates check constraint "different_teams"
DETAIL:  Failing row contains (1, 2025-11-01 14:16:55.208525+00, 1, 1, 1, prematch, 2025-10-31 14:16:55.213986+00, 2025-10-31 14:16:55.213986+00). - Query: 
            INSERT INTO events (date, competition_id, team_a_id, team_b_id, status)
            VAL
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.CheckViolationError: new row for relation "events" violates check constraint "different_teams"
DETAIL:  Failing row contains (1, 2025-11-01 14:16:55.208525+00, 1, 1, 1, prematch, 2025-10-31 14:16:55.213986+00, 2025-10-31 14:16:55.213986+00).
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 400 Bad Request"
2025-10-31 14:16:55 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:55 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: GET http://test/api/events/1 "HTTP/1.1 200 OK"
2025-10-31 14:16:55 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:55 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: PUT http://test/api/events/1 "HTTP/1.1 200 OK"
2025-10-31 14:16:55 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:55 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: DELETE http://test/api/events/1 "HTTP/1.1 204 No Content"
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: GET http://test/api/events/1 "HTTP/1.1 404 Not Found"
2025-10-31 14:16:55 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:55 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:55 - httpx - INFO - HTTP Request: GET http://test/ "HTTP/1.1 200 OK"
2025-10-31 14:16:55 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:56 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:56 - httpx - INFO - HTTP Request: GET http://test/health "HTTP/1.1 200 OK"
2025-10-31 14:16:56 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:56 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:56 - httpx - INFO - HTTP Request: GET http://test/api/sports "HTTP/1.1 200 OK"
2025-10-31 14:16:56 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:56 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:56 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:56 - httpx - INFO - HTTP Request: GET http://test/api/sports/Tennis "HTTP/1.1 200 OK"
2025-10-31 14:16:56 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:56 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:56 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:56 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:56 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:56 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:56 - database - ERROR - Database insert error: duplicate key value violates unique constraint "sports_pkey"
DETAIL:  Key (name)=(Rugby) already exists. - Query: INSERT INTO sports (name) VALUES ($1) RETURNING name
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 121, in execute_insert
    result = await conn.fetchval(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 715, in fetchval
    data = await self._execute(query, args, 1, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "sports_pkey"
DETAIL:  Key (name)=(Rugby) already exists.
2025-10-31 14:16:56 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 409 Conflict"
2025-10-31 14:16:56 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:56 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:56 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:16:56 - httpx - INFO - HTTP Request: DELETE http://test/api/sports/Cricket "HTTP/1.1 204 No Content"
2025-10-31 14:16:56 - httpx - INFO - HTTP Request: GET http://test/api/sports/Cricket "HTTP/1.1 404 Not Found"
2025-10-31 14:16:56 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:57 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:57 - httpx - INFO - HTTP Request: DELETE http://test/api/sports/NonexistentSport "HTTP/1.1 404 Not Found"
2025-10-31 14:16:57 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:57 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:57 - httpx - INFO - HTTP Request: GET http://test/api/sports/NonexistentSport "HTTP/1.1 404 Not Found"
2025-10-31 14:16:57 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:57 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:57 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:16:57 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:57 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:57 - httpx - INFO - HTTP Request: GET http://test/api/teams?sport=Football "HTTP/1.1 200 OK"
2025-10-31 14:16:57 - httpx - INFO - HTTP Request: GET http://test/api/teams?country=USA "HTTP/1.1 200 OK"
2025-10-31 14:16:57 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:57 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:57 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 14:16:57 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:57 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:57 - database - ERROR - Database query error: insert or update on table "teams" violates foreign key constraint "teams_sport_fkey"
DETAIL:  Key (sport)=(InvalidSport) is not present in table "sports". - Query: 
            INSERT INTO teams (name, country, sport)
            VALUES ($1, $2, $3)
            RE
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: insert or update on table "teams" violates foreign key constraint "teams_sport_fkey"
DETAIL:  Key (sport)=(InvalidSport) is not present in table "sports".
2025-10-31 14:16:57 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 400 Bad Request"
2025-10-31 14:16:57 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:58 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:58 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 14:16:58 - httpx - INFO - HTTP Request: GET http://test/api/teams/3 "HTTP/1.1 200 OK"
2025-10-31 14:16:58 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:58 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:58 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 14:16:58 - httpx - INFO - HTTP Request: PUT http://test/api/teams/3 "HTTP/1.1 200 OK"
2025-10-31 14:16:58 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:16:58 - database - INFO - Database connection pool created successfully
2025-10-31 14:16:58 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 14:16:58 - httpx - INFO - HTTP Request: DELETE http://test/api/teams/3 "HTTP/1.1 204 No Content"
2025-10-31 14:16:58 - httpx - INFO - HTTP Request: GET http://test/api/teams/3 "HTTP/1.1 404 Not Found"
2025-10-31 14:17:22 - root - INFO - Logging configured - Level: INFO
2025-10-31 14:17:22 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:22 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:22 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:17:22 - httpx - INFO - HTTP Request: GET http://test/api/audit "HTTP/1.1 200 OK"
2025-10-31 14:17:23 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:23 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:23 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:17:23 - httpx - INFO - HTTP Request: GET http://test/api/audit?table_name=sports "HTTP/1.1 200 OK"
2025-10-31 14:17:23 - httpx - INFO - HTTP Request: GET http://test/api/audit?operation=INSERT "HTTP/1.1 200 OK"
2025-10-31 14:17:23 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:23 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:23 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:17:23 - httpx - INFO - HTTP Request: GET http://test/api/audit?table_name=sports "HTTP/1.1 200 OK"
2025-10-31 14:17:23 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:23 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:23 - httpx - INFO - HTTP Request: GET http://test/api/bets "HTTP/1.1 200 OK"
2025-10-31 14:17:23 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:23 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:23 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:17:23 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:17:23 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 14:17:23 - httpx - INFO - HTTP Request: GET http://test/api/customers "HTTP/1.1 200 OK"
2025-10-31 14:17:23 - httpx - INFO - HTTP Request: POST http://test/api/bets "HTTP/1.1 201 Created"
2025-10-31 14:17:23 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:23 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:23 - httpx - INFO - HTTP Request: GET http://test/api/bets "HTTP/1.1 200 OK"
2025-10-31 14:17:23 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:24 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:24 - httpx - INFO - HTTP Request: GET http://test/api/customers "HTTP/1.1 200 OK"
2025-10-31 14:17:24 - httpx - INFO - HTTP Request: GET http://test/api/bets?customer_id=1 "HTTP/1.1 200 OK"
2025-10-31 14:17:24 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:24 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:24 - httpx - INFO - HTTP Request: GET http://test/api/bets "HTTP/1.1 200 OK"
2025-10-31 14:17:24 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:24 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:24 - httpx - INFO - HTTP Request: GET http://test/api/bets "HTTP/1.1 200 OK"
2025-10-31 14:17:24 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:24 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:24 - httpx - INFO - HTTP Request: GET http://test/api/customers "HTTP/1.1 200 OK"
2025-10-31 14:17:24 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:24 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:24 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 14:17:24 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:24 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:24 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 14:17:24 - database - ERROR - Database query error: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists. - Query: 
            INSERT INTO customers (username, password, real_name, currency, status, balance, prefer
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists.
2025-10-31 14:17:24 - routers.customers - ERROR - Error creating customer - Username: duplicate_test, Error: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists.
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/routers/customers.py", line 120, in create_customer
    result = await execute_one(
             ^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists.
2025-10-31 14:17:24 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 409 Conflict"
2025-10-31 14:17:24 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:25 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:25 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 14:17:25 - httpx - INFO - HTTP Request: GET http://test/api/customers/2 "HTTP/1.1 200 OK"
2025-10-31 14:17:25 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:25 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:25 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 14:17:25 - httpx - INFO - HTTP Request: PUT http://test/api/customers/2 "HTTP/1.1 200 OK"
2025-10-31 14:17:25 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:25 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:25 - httpx - INFO - HTTP Request: GET http://test/api/customers?status=active "HTTP/1.1 200 OK"
2025-10-31 14:17:25 - httpx - INFO - HTTP Request: GET http://test/api/customers?currency=USD "HTTP/1.1 200 OK"
2025-10-31 14:17:25 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:25 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:25 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 14:17:25 - httpx - INFO - HTTP Request: DELETE http://test/api/customers/2 "HTTP/1.1 204 No Content"
2025-10-31 14:17:25 - httpx - INFO - HTTP Request: GET http://test/api/customers/2 "HTTP/1.1 404 Not Found"
2025-10-31 14:17:25 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:25 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:25 - httpx - INFO - HTTP Request: GET http://test/api/events "HTTP/1.1 200 OK"
2025-10-31 14:17:25 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:25 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:25 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:17:25 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:17:25 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 14:17:25 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:26 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:17:26 - database - ERROR - Database query error: new row for relation "events" violates check constraint "different_teams"
DETAIL:  Failing row contains (1, 2025-11-01 14:17:26.066007+00, 1, 1, 1, prematch, 2025-10-31 14:17:26.071018+00, 2025-10-31 14:17:26.071018+00). - Query: 
            INSERT INTO events (date, competition_id, team_a_id, team_b_id, status)
            VAL
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.CheckViolationError: new row for relation "events" violates check constraint "different_teams"
DETAIL:  Failing row contains (1, 2025-11-01 14:17:26.066007+00, 1, 1, 1, prematch, 2025-10-31 14:17:26.071018+00, 2025-10-31 14:17:26.071018+00).
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 400 Bad Request"
2025-10-31 14:17:26 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:26 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: GET http://test/api/events/1 "HTTP/1.1 200 OK"
2025-10-31 14:17:26 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:26 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: PUT http://test/api/events/1 "HTTP/1.1 200 OK"
2025-10-31 14:17:26 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:26 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: DELETE http://test/api/events/1 "HTTP/1.1 204 No Content"
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: GET http://test/api/events/1 "HTTP/1.1 404 Not Found"
2025-10-31 14:17:26 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:26 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: GET http://test/ "HTTP/1.1 200 OK"
2025-10-31 14:17:26 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:26 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:26 - httpx - INFO - HTTP Request: GET http://test/health "HTTP/1.1 200 OK"
2025-10-31 14:17:26 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:27 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:27 - httpx - INFO - HTTP Request: GET http://test/api/sports "HTTP/1.1 200 OK"
2025-10-31 14:17:27 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:27 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:27 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:17:27 - httpx - INFO - HTTP Request: GET http://test/api/sports/Tennis "HTTP/1.1 200 OK"
2025-10-31 14:17:27 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:27 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:27 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:17:27 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:27 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:27 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:17:27 - database - ERROR - Database insert error: duplicate key value violates unique constraint "sports_pkey"
DETAIL:  Key (name)=(Rugby) already exists. - Query: INSERT INTO sports (name) VALUES ($1) RETURNING name
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 121, in execute_insert
    result = await conn.fetchval(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 715, in fetchval
    data = await self._execute(query, args, 1, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "sports_pkey"
DETAIL:  Key (name)=(Rugby) already exists.
2025-10-31 14:17:27 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 409 Conflict"
2025-10-31 14:17:27 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:27 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:27 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 14:17:27 - httpx - INFO - HTTP Request: DELETE http://test/api/sports/Cricket "HTTP/1.1 204 No Content"
2025-10-31 14:17:27 - httpx - INFO - HTTP Request: GET http://test/api/sports/Cricket "HTTP/1.1 404 Not Found"
2025-10-31 14:17:27 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:27 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:27 - httpx - INFO - HTTP Request: DELETE http://test/api/sports/NonexistentSport "HTTP/1.1 404 Not Found"
2025-10-31 14:17:27 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:28 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:28 - httpx - INFO - HTTP Request: GET http://test/api/sports/NonexistentSport "HTTP/1.1 404 Not Found"
2025-10-31 14:17:28 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:28 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:28 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 14:17:28 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:28 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:28 - httpx - INFO - HTTP Request: GET http://test/api/teams?sport=Football "HTTP/1.1 200 OK"
2025-10-31 14:17:28 - httpx - INFO - HTTP Request: GET http://test/api/teams?country=USA "HTTP/1.1 200 OK"
2025-10-31 14:17:28 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:28 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:28 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 14:17:28 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:28 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:28 - database - ERROR - Database query error: insert or update on table "teams" violates foreign key constraint "teams_sport_fkey"
DETAIL:  Key (sport)=(InvalidSport) is not present in table "sports". - Query: 
            INSERT INTO teams (name, country, sport)
            VALUES ($1, $2, $3)
            RE
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: insert or update on table "teams" violates foreign key constraint "teams_sport_fkey"
DETAIL:  Key (sport)=(InvalidSport) is not present in table "sports".
2025-10-31 14:17:28 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 400 Bad Request"
2025-10-31 14:17:28 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:28 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:28 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 14:17:28 - httpx - INFO - HTTP Request: GET http://test/api/teams/3 "HTTP/1.1 200 OK"
2025-10-31 14:17:28 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:29 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:29 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 14:17:29 - httpx - INFO - HTTP Request: PUT http://test/api/teams/3 "HTTP/1.1 200 OK"
2025-10-31 14:17:29 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 14:17:29 - database - INFO - Database connection pool created successfully
2025-10-31 14:17:29 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 14:17:29 - httpx - INFO - HTTP Request: DELETE http://test/api/teams/3 "HTTP/1.1 204 No Content"
2025-10-31 14:17:29 - httpx - INFO - HTTP Request: GET http://test/api/teams/3 "HTTP/1.1 404 Not Found"
2025-10-31 15:17:18 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:17:18 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 15:17:18 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 15:17:18 - database - INFO - Database connection pool created successfully
2025-10-31 15:17:18 - main - INFO - Database connection pool created successfully
2025-10-31 15:19:32 - database - ERROR - Database query error: Bet sport Basketball does not match event sport Football - Query: 
            INSERT INTO bets (
                bookie, customer_id, bookie_bet_id, bet_type, event_
Traceback (most recent call last):
  File "/app/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.RaiseError: Bet sport Basketball does not match event sport Football
2025-10-31 15:19:32 - routers.bets - ERROR - Error creating bet - Bookie: Himanshu, Customer ID: 2, Event ID: 3, Error: Bet sport Basketball does not match event sport Football
Traceback (most recent call last):
  File "/app/routers/bets.py", line 146, in create_bet
    result = await execute_one(
             ^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.RaiseError: Bet sport Basketball does not match event sport Football
2025-10-31 15:19:39 - database - ERROR - Database query error: Bet sport Baseball does not match event sport Football - Query: 
            INSERT INTO bets (
                bookie, customer_id, bookie_bet_id, bet_type, event_
Traceback (most recent call last):
  File "/app/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.RaiseError: Bet sport Baseball does not match event sport Football
2025-10-31 15:19:39 - routers.bets - ERROR - Error creating bet - Bookie: Himanshu, Customer ID: 2, Event ID: 3, Error: Bet sport Baseball does not match event sport Football
Traceback (most recent call last):
  File "/app/routers/bets.py", line 146, in create_bet
    result = await execute_one(
             ^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.RaiseError: Bet sport Baseball does not match event sport Football
2025-10-31 15:23:23 - database - ERROR - Database update/delete error: update or delete on table "customers" violates foreign key constraint "balance_changes_customer_id_fkey" on table "balance_changes"
DETAIL:  Key (id)=(3) is still referenced from table "balance_changes". - Query: DELETE FROM customers WHERE id = $1
Traceback (most recent call last):
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "customers" violates foreign key constraint "balance_changes_customer_id_fkey" on table "balance_changes"
DETAIL:  Key (id)=(3) is still referenced from table "balance_changes".
2025-10-31 15:23:23 - main - ERROR - Unhandled exception: update or delete on table "customers" violates foreign key constraint "balance_changes_customer_id_fkey" on table "balance_changes"
DETAIL:  Key (id)=(3) is still referenced from table "balance_changes". - Path: /api/customers/3 - Method: DELETE
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/customers.py", line 258, in delete_customer
    affected = await execute_update(query, customer_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "customers" violates foreign key constraint "balance_changes_customer_id_fkey" on table "balance_changes"
DETAIL:  Key (id)=(3) is still referenced from table "balance_changes".
2025-10-31 15:23:35 - database - ERROR - Database update/delete error: update or delete on table "teams" violates foreign key constraint "events_team_b_id_fkey" on table "events"
DETAIL:  Key (id)=(4) is still referenced from table "events". - Query: DELETE FROM teams WHERE id = $1
Traceback (most recent call last):
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "teams" violates foreign key constraint "events_team_b_id_fkey" on table "events"
DETAIL:  Key (id)=(4) is still referenced from table "events".
2025-10-31 15:23:35 - main - ERROR - Unhandled exception: update or delete on table "teams" violates foreign key constraint "events_team_b_id_fkey" on table "events"
DETAIL:  Key (id)=(4) is still referenced from table "events". - Path: /api/teams/4 - Method: DELETE
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/teams.py", line 139, in delete_team
    affected = await execute_update(query, team_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "teams" violates foreign key constraint "events_team_b_id_fkey" on table "events"
DETAIL:  Key (id)=(4) is still referenced from table "events".
2025-10-31 15:23:40 - database - ERROR - Database update/delete error: update or delete on table "competitions" violates foreign key constraint "events_competition_id_fkey" on table "events"
DETAIL:  Key (id)=(3) is still referenced from table "events". - Query: DELETE FROM competitions WHERE id = $1
Traceback (most recent call last):
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "competitions" violates foreign key constraint "events_competition_id_fkey" on table "events"
DETAIL:  Key (id)=(3) is still referenced from table "events".
2025-10-31 15:23:40 - main - ERROR - Unhandled exception: update or delete on table "competitions" violates foreign key constraint "events_competition_id_fkey" on table "events"
DETAIL:  Key (id)=(3) is still referenced from table "events". - Path: /api/competitions/3 - Method: DELETE
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/competitions.py", line 143, in delete_competition
    affected = await execute_update(query, competition_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "competitions" violates foreign key constraint "events_competition_id_fkey" on table "events"
DETAIL:  Key (id)=(3) is still referenced from table "events".
2025-10-31 15:29:02 - main - INFO - Shutting down...
2025-10-31 15:29:02 - main - INFO - Database connection pool closed successfully
2025-10-31 15:29:03 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:29:03 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 15:29:03 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 15:29:03 - database - INFO - Database connection pool created successfully
2025-10-31 15:29:03 - main - INFO - Database connection pool created successfully
2025-10-31 15:36:04 - database - ERROR - Database query error: Teams must play the same sport. Team A plays Football but Team B plays Basketball - Query: 
            INSERT INTO events (date, competition_id, team_a_id, team_b_id, status)
            VAL
Traceback (most recent call last):
  File "/app/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.RaiseError: Teams must play the same sport. Team A plays Football but Team B plays Basketball
2025-10-31 15:36:27 - database - ERROR - Database update/delete error: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets". - Query: DELETE FROM events WHERE id = $1
Traceback (most recent call last):
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets".
2025-10-31 15:36:27 - main - ERROR - Unhandled exception: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets". - Path: /api/events/5 - Method: DELETE
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/events.py", line 170, in delete_event
    affected = await execute_update(query, event_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets".
2025-10-31 15:37:51 - main - INFO - Shutting down...
2025-10-31 15:37:51 - main - INFO - Database connection pool closed successfully
ion pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:37:18 - database - INFO - Database connection pool created successfully
2025-10-31 15:37:18 - httpx - INFO - HTTP Request: GET http://test/api/events "HTTP/1.1 200 OK"
2025-10-31 15:37:18 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:37:18 - database - INFO - Database connection pool created successfully
2025-10-31 15:37:18 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:37:18 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:37:18 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:37:18 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:37:18 - database - INFO - Database connection pool created successfully
2025-10-31 15:37:18 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:37:18 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:37:18 - database - ERROR - Database query error: new row for relation "events" violates check constraint "different_teams"
DETAIL:  Failing row contains (1, 2025-11-01 15:37:18.518796+00, 1, 1, 1, prematch, 2025-10-31 15:37:18.526339+00, 2025-10-31 15:37:18.526339+00). - Query: 
            INSERT INTO events (date, competition_id, team_a_id, team_b_id, status)
            VAL
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.CheckViolationError: new row for relation "events" violates check constraint "different_teams"
DETAIL:  Failing row contains (1, 2025-11-01 15:37:18.518796+00, 1, 1, 1, prematch, 2025-10-31 15:37:18.526339+00, 2025-10-31 15:37:18.526339+00).
2025-10-31 15:37:18 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 400 Bad Request"
2025-10-31 15:37:18 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:37:18 - database - INFO - Database connection pool created successfully
2025-10-31 15:37:18 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:37:18 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:37:18 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:37:18 - httpx - INFO - HTTP Request: GET http://test/api/events/1 "HTTP/1.1 200 OK"
2025-10-31 15:37:18 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:37:18 - database - INFO - Database connection pool created successfully
2025-10-31 15:37:18 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:37:18 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:37:18 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:37:18 - httpx - INFO - HTTP Request: PUT http://test/api/events/1 "HTTP/1.1 200 OK"
2025-10-31 15:37:19 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:37:19 - database - INFO - Database connection pool created successfully
2025-10-31 15:37:19 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:37:19 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:37:19 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:37:19 - httpx - INFO - HTTP Request: DELETE http://test/api/events/1 "HTTP/1.1 204 No Content"
2025-10-31 15:37:19 - httpx - INFO - HTTP Request: GET http://test/api/events/1 "HTTP/1.1 404 Not Found"
2025-10-31 15:37:51 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:37:51 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 15:37:51 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 15:37:52 - database - INFO - Database connection pool created successfully
2025-10-31 15:37:52 - main - INFO - Database connection pool created successfully
2025-10-31 15:38:11 - database - ERROR - Database update/delete error: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets". - Query: DELETE FROM events WHERE id = $1
Traceback (most recent call last):
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets".
2025-10-31 15:38:11 - main - ERROR - Unhandled exception: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets". - Path: /api/events/5 - Method: DELETE
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/events.py", line 170, in delete_event
    affected = await execute_update(query, event_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets".
2025-10-31 15:38:18 - database - ERROR - Database update/delete error: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets". - Query: DELETE FROM events WHERE id = $1
Traceback (most recent call last):
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets".
2025-10-31 15:38:18 - main - ERROR - Unhandled exception: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets". - Path: /api/events/5 - Method: DELETE
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/events.py", line 170, in delete_event
    affected = await execute_update(query, event_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets".
2025-10-31 15:38:58 - main - INFO - Shutting down...
2025-10-31 15:38:58 - main - INFO - Database connection pool closed successfully
2025-10-31 15:38:58 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:38:58 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 15:38:58 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 15:38:59 - database - INFO - Database connection pool created successfully
2025-10-31 15:38:59 - main - INFO - Database connection pool created successfully
2025-10-31 15:39:24 - main - INFO - Shutting down...
2025-10-31 15:39:24 - main - INFO - Database connection pool closed successfully
2025-10-31 15:39:24 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:39:24 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 15:39:24 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 15:39:24 - database - INFO - Database connection pool created successfully
2025-10-31 15:39:24 - main - INFO - Database connection pool created successfully
2025-10-31 15:39:44 - main - INFO - Shutting down...
2025-10-31 15:39:44 - main - INFO - Database connection pool closed successfully
2025-10-31 15:39:45 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:39:45 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 15:39:45 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 15:39:45 - database - INFO - Database connection pool created successfully
2025-10-31 15:39:45 - main - INFO - Database connection pool created successfully
2025-10-31 15:40:15 - main - INFO - Shutting down...
2025-10-31 15:40:15 - main - INFO - Database connection pool closed successfully
ion pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:39:54 - database - INFO - Database connection pool created successfully
2025-10-31 15:39:54 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:39:54 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:39:54 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:39:54 - httpx - INFO - HTTP Request: DELETE http://test/api/events/1 "HTTP/1.1 204 No Content"
2025-10-31 15:39:54 - httpx - INFO - HTTP Request: GET http://test/api/events/1 "HTTP/1.1 404 Not Found"
2025-10-31 15:40:16 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:40:16 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 15:40:16 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 15:40:16 - database - INFO - Database connection pool created successfully
2025-10-31 15:40:16 - main - INFO - Database connection pool created successfully
2025-10-31 15:40:21 - database - ERROR - Database update/delete error: update or delete on table "customers" violates foreign key constraint "balance_changes_customer_id_fkey" on table "balance_changes"
DETAIL:  Key (id)=(3) is still referenced from table "balance_changes". - Query: DELETE FROM customers WHERE id = $1
Traceback (most recent call last):
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "customers" violates foreign key constraint "balance_changes_customer_id_fkey" on table "balance_changes"
DETAIL:  Key (id)=(3) is still referenced from table "balance_changes".
2025-10-31 15:40:21 - main - ERROR - Unhandled exception: update or delete on table "customers" violates foreign key constraint "balance_changes_customer_id_fkey" on table "balance_changes"
DETAIL:  Key (id)=(3) is still referenced from table "balance_changes". - Path: /api/customers/3 - Method: DELETE
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/customers.py", line 258, in delete_customer
    affected = await execute_update(query, customer_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "customers" violates foreign key constraint "balance_changes_customer_id_fkey" on table "balance_changes"
DETAIL:  Key (id)=(3) is still referenced from table "balance_changes".
2025-10-31 15:40:26 - database - ERROR - Database update/delete error: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets". - Query: DELETE FROM events WHERE id = $1
Traceback (most recent call last):
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets".
2025-10-31 15:40:26 - main - ERROR - Unhandled exception: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets". - Path: /api/events/5 - Method: DELETE
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/events.py", line 170, in delete_event
    affected = await execute_update(query, event_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets".
2025-10-31 15:40:51 - database - ERROR - Database update/delete error: update or delete on table "events" violates foreign key constraint "results_event_id_fkey" on table "results"
DETAIL:  Key (id)=(1) is still referenced from table "results". - Query: DELETE FROM events WHERE id = $1
Traceback (most recent call last):
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "events" violates foreign key constraint "results_event_id_fkey" on table "results"
DETAIL:  Key (id)=(1) is still referenced from table "results".
2025-10-31 15:40:51 - main - ERROR - Unhandled exception: update or delete on table "events" violates foreign key constraint "results_event_id_fkey" on table "results"
DETAIL:  Key (id)=(1) is still referenced from table "results". - Path: /api/events/1 - Method: DELETE
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/events.py", line 170, in delete_event
    affected = await execute_update(query, event_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "events" violates foreign key constraint "results_event_id_fkey" on table "results"
DETAIL:  Key (id)=(1) is still referenced from table "results".
2025-10-31 15:44:26 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:44:27 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:44:27 - database - INFO - Database connection pool created successfully
2025-10-31 15:44:27 - httpx - INFO - HTTP Request: GET http://test/api/events "HTTP/1.1 200 OK"
2025-10-31 15:44:27 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:44:27 - database - INFO - Database connection pool created successfully
2025-10-31 15:44:27 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:44:27 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:44:27 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:44:27 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:44:27 - database - INFO - Database connection pool created successfully
2025-10-31 15:44:27 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:44:27 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:44:27 - main - WARNING - Validation error: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:44:27.535276', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}] - Path: /api/events - Method: POST - Errors: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:44:27.535276', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]
2025-10-31 15:44:27 - main - ERROR - Unhandled exception: Object of type ValueError is not JSON serializable - Path: /api/events - Method: POST
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 272, in app
    raise RequestValidationError(_normalize_errors(errors), body=body)
fastapi.exceptions.RequestValidationError: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:44:27.535276', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 88, in __call__
    response = await handler(request, exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/main.py", line 98, in validation_exception_handler
    return JSONResponse(
           ^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 196, in __init__
    super().__init__(content, status_code, headers, media_type, background)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 55, in __init__
    self.body = self.render(content)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 199, in render
    return json.dumps(
           ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ValueError is not JSON serializable
2025-10-31 15:44:27 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:44:27 - database - INFO - Database connection pool created successfully
2025-10-31 15:44:27 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:44:27 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:44:27 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:44:27 - httpx - INFO - HTTP Request: GET http://test/api/events/1 "HTTP/1.1 200 OK"
2025-10-31 15:44:28 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:44:28 - database - INFO - Database connection pool created successfully
2025-10-31 15:44:28 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:44:28 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:44:28 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:44:28 - httpx - INFO - HTTP Request: PUT http://test/api/events/1 "HTTP/1.1 200 OK"
2025-10-31 15:44:28 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:44:28 - database - INFO - Database connection pool created successfully
2025-10-31 15:44:28 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:44:28 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:44:28 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:44:28 - httpx - INFO - HTTP Request: DELETE http://test/api/events/1 "HTTP/1.1 204 No Content"
2025-10-31 15:44:28 - httpx - INFO - HTTP Request: GET http://test/api/events/1 "HTTP/1.1 404 Not Found"
2025-10-31 15:44:43 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:44:43 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:44:43 - database - INFO - Database connection pool created successfully
2025-10-31 15:44:43 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:44:43 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:44:43 - main - WARNING - Validation error: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:44:43.884046', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}] - Path: /api/events - Method: POST - Errors: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:44:43.884046', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]
2025-10-31 15:44:43 - main - ERROR - Unhandled exception: Object of type ValueError is not JSON serializable - Path: /api/events - Method: POST
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 272, in app
    raise RequestValidationError(_normalize_errors(errors), body=body)
fastapi.exceptions.RequestValidationError: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:44:43.884046', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 88, in __call__
    response = await handler(request, exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/main.py", line 98, in validation_exception_handler
    return JSONResponse(
           ^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 196, in __init__
    super().__init__(content, status_code, headers, media_type, background)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 55, in __init__
    self.body = self.render(content)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 199, in render
    return json.dumps(
           ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ValueError is not JSON serializable
2025-10-31 15:45:54 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:45:54 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:45:54 - database - INFO - Database connection pool created successfully
2025-10-31 15:45:54 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:45:54 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:45:54 - main - WARNING - Validation error: body: Value error, Team A and Team B must be different - Path: /api/events - Method: POST - Errors: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:45:54.932743', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]
2025-10-31 15:45:54 - main - ERROR - Unhandled exception: Object of type ValueError is not JSON serializable - Path: /api/events - Method: POST
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 272, in app
    raise RequestValidationError(_normalize_errors(errors), body=body)
fastapi.exceptions.RequestValidationError: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:45:54.932743', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 88, in __call__
    response = await handler(request, exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/main.py", line 121, in validation_exception_handler
    return JSONResponse(
           ^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 196, in __init__
    super().__init__(content, status_code, headers, media_type, background)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 55, in __init__
    self.body = self.render(content)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 199, in render
    return json.dumps(
           ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ValueError is not JSON serializable
2025-10-31 15:46:02 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:46:03 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:46:03 - database - INFO - Database connection pool created successfully
2025-10-31 15:46:03 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:46:03 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:46:03 - main - WARNING - Validation error: body: Value error, Team A and Team B must be different - Path: /api/events - Method: POST - Errors: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:46:03.151057', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]
2025-10-31 15:46:03 - main - ERROR - Unhandled exception: Object of type ValueError is not JSON serializable - Path: /api/events - Method: POST
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 272, in app
    raise RequestValidationError(_normalize_errors(errors), body=body)
fastapi.exceptions.RequestValidationError: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:46:03.151057', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 88, in __call__
    response = await handler(request, exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/main.py", line 121, in validation_exception_handler
    return JSONResponse(
           ^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 196, in __init__
    super().__init__(content, status_code, headers, media_type, background)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 55, in __init__
    self.body = self.render(content)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 199, in render
    return json.dumps(
           ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ValueError is not JSON serializable
2025-10-31 15:50:14 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:50:15 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:50:15 - database - INFO - Database connection pool created successfully
2025-10-31 15:50:15 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:50:15 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:50:15 - main - WARNING - Validation error: body: Value error, Team A and Team B must be different - Path: /api/events - Method: POST - Errors: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:50:15.401278', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]
2025-10-31 15:50:15 - main - ERROR - Unhandled exception: Object of type ValueError is not JSON serializable - Path: /api/events - Method: POST
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 272, in app
    raise RequestValidationError(_normalize_errors(errors), body=body)
fastapi.exceptions.RequestValidationError: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:50:15.401278', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 88, in __call__
    response = await handler(request, exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/main.py", line 121, in validation_exception_handler
    return JSONResponse(
           ^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 196, in __init__
    super().__init__(content, status_code, headers, media_type, background)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 55, in __init__
    self.body = self.render(content)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 199, in render
    return json.dumps(
           ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ValueError is not JSON serializable
2025-10-31 15:52:09 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:52:09 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:52:09 - database - INFO - Database connection pool created successfully
2025-10-31 15:52:09 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:52:09 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:52:09 - main - WARNING - Validation error: body: Value error, Team A and Team B must be different - Path: /api/events - Method: POST - Errors: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:52:09.637878', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]
2025-10-31 15:52:09 - main - ERROR - Unhandled exception: Object of type ValueError is not JSON serializable - Path: /api/events - Method: POST
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 272, in app
    raise RequestValidationError(_normalize_errors(errors), body=body)
fastapi.exceptions.RequestValidationError: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:52:09.637878', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 88, in __call__
    response = await handler(request, exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/main.py", line 121, in validation_exception_handler
    return JSONResponse(
           ^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 196, in __init__
    super().__init__(content, status_code, headers, media_type, background)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 55, in __init__
    self.body = self.render(content)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 199, in render
    return json.dumps(
           ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ValueError is not JSON serializable
2025-10-31 15:52:13 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:52:13 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:52:13 - database - INFO - Database connection pool created successfully
2025-10-31 15:52:13 - httpx - INFO - HTTP Request: GET http://test/api/events "HTTP/1.1 200 OK"
2025-10-31 15:52:13 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:52:13 - database - INFO - Database connection pool created successfully
2025-10-31 15:52:13 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:52:13 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:52:13 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:52:13 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:52:13 - database - INFO - Database connection pool created successfully
2025-10-31 15:52:13 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:52:13 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:52:13 - main - WARNING - Validation error: body: Value error, Team A and Team B must be different - Path: /api/events - Method: POST - Errors: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:52:13.842472', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]
2025-10-31 15:52:13 - main - ERROR - Unhandled exception: Object of type ValueError is not JSON serializable - Path: /api/events - Method: POST
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 272, in app
    raise RequestValidationError(_normalize_errors(errors), body=body)
fastapi.exceptions.RequestValidationError: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:52:13.842472', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 88, in __call__
    response = await handler(request, exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/main.py", line 121, in validation_exception_handler
    return JSONResponse(
           ^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 196, in __init__
    super().__init__(content, status_code, headers, media_type, background)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 55, in __init__
    self.body = self.render(content)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 199, in render
    return json.dumps(
           ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ValueError is not JSON serializable
2025-10-31 15:52:14 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:52:14 - database - INFO - Database connection pool created successfully
2025-10-31 15:52:14 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:52:14 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:52:14 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:52:14 - httpx - INFO - HTTP Request: GET http://test/api/events/1 "HTTP/1.1 200 OK"
2025-10-31 15:52:14 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:52:14 - database - INFO - Database connection pool created successfully
2025-10-31 15:52:14 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:52:14 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:52:14 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:52:14 - httpx - INFO - HTTP Request: PUT http://test/api/events/1 "HTTP/1.1 200 OK"
2025-10-31 15:52:14 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:52:14 - database - INFO - Database connection pool created successfully
2025-10-31 15:52:14 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:52:14 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:52:14 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:52:14 - httpx - INFO - HTTP Request: DELETE http://test/api/events/1 "HTTP/1.1 204 No Content"
2025-10-31 15:52:14 - httpx - INFO - HTTP Request: GET http://test/api/events/1 "HTTP/1.1 404 Not Found"
2025-10-31 15:52:45 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:52:45 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:52:45 - database - INFO - Database connection pool created successfully
2025-10-31 15:52:45 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:52:45 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:52:45 - main - WARNING - Validation error: body: Value error, Team A and Team B must be different - Path: /api/events - Method: POST - Errors: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:52:45.430647', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]
2025-10-31 15:52:45 - main - ERROR - Unhandled exception: Object of type ValueError is not JSON serializable - Path: /api/events - Method: POST
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 272, in app
    raise RequestValidationError(_normalize_errors(errors), body=body)
fastapi.exceptions.RequestValidationError: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:52:45.430647', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 88, in __call__
    response = await handler(request, exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/main.py", line 121, in validation_exception_handler
    return JSONResponse(
           ^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 196, in __init__
    super().__init__(content, status_code, headers, media_type, background)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 55, in __init__
    self.body = self.render(content)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 199, in render
    return json.dumps(
           ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ValueError is not JSON serializable
2025-10-31 15:52:52 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:52:52 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:52:52 - database - INFO - Database connection pool created successfully
2025-10-31 15:52:52 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:52:52 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:52:52 - main - WARNING - Validation error: body: Value error, Team A and Team B must be different - Path: /api/events - Method: POST - Errors: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:52:52.851368', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]
2025-10-31 15:52:52 - main - ERROR - Unhandled exception: Object of type ValueError is not JSON serializable - Path: /api/events - Method: POST
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/fastapi/routing.py", line 272, in app
    raise RequestValidationError(_normalize_errors(errors), body=body)
fastapi.exceptions.RequestValidationError: [{'type': 'value_error', 'loc': ('body',), 'msg': 'Value error, Team A and Team B must be different', 'input': {'date': '2025-11-01T15:52:52.851368', 'competition_id': 1, 'team_a_id': 1, 'team_b_id': 1, 'status': 'prematch'}, 'ctx': {'error': ValueError('Team A and Team B must be different')}, 'url': 'https://errors.pydantic.dev/2.5/v/value_error'}]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 88, in __call__
    response = await handler(request, exc)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/main.py", line 121, in validation_exception_handler
    return JSONResponse(
           ^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 196, in __init__
    super().__init__(content, status_code, headers, media_type, background)
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 55, in __init__
    self.body = self.render(content)
                ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/starlette/responses.py", line 199, in render
    return json.dumps(
           ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ValueError is not JSON serializable
2025-10-31 15:53:17 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:53:17 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:17 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:17 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:53:17 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:53:17 - main - WARNING - Validation error: body: Team A and Team B must be different - Path: /api/events - Method: POST
2025-10-31 15:53:17 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 422 Unprocessable Entity"
2025-10-31 15:53:24 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:53:25 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:25 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:25 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 15:53:25 - httpx - INFO - HTTP Request: GET http://test/api/audit "HTTP/1.1 200 OK"
2025-10-31 15:53:25 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:25 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:25 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 15:53:25 - httpx - INFO - HTTP Request: GET http://test/api/audit?table_name=sports "HTTP/1.1 200 OK"
2025-10-31 15:53:25 - httpx - INFO - HTTP Request: GET http://test/api/audit?operation=INSERT "HTTP/1.1 200 OK"
2025-10-31 15:53:25 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:25 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:25 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 15:53:25 - httpx - INFO - HTTP Request: GET http://test/api/audit?table_name=sports "HTTP/1.1 200 OK"
2025-10-31 15:53:25 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:25 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:25 - httpx - INFO - HTTP Request: GET http://test/api/bets "HTTP/1.1 200 OK"
2025-10-31 15:53:25 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:26 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:26 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:53:26 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:53:26 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:53:26 - httpx - INFO - HTTP Request: GET http://test/api/customers "HTTP/1.1 200 OK"
2025-10-31 15:53:26 - httpx - INFO - HTTP Request: POST http://test/api/bets "HTTP/1.1 201 Created"
2025-10-31 15:53:26 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:26 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:26 - httpx - INFO - HTTP Request: GET http://test/api/bets "HTTP/1.1 200 OK"
2025-10-31 15:53:26 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:26 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:26 - httpx - INFO - HTTP Request: GET http://test/api/customers "HTTP/1.1 200 OK"
2025-10-31 15:53:26 - httpx - INFO - HTTP Request: GET http://test/api/bets?customer_id=1 "HTTP/1.1 200 OK"
2025-10-31 15:53:26 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:26 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:26 - httpx - INFO - HTTP Request: GET http://test/api/bets "HTTP/1.1 200 OK"
2025-10-31 15:53:26 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:26 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:26 - httpx - INFO - HTTP Request: GET http://test/api/bets "HTTP/1.1 200 OK"
2025-10-31 15:53:26 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:27 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:27 - httpx - INFO - HTTP Request: GET http://test/api/customers "HTTP/1.1 200 OK"
2025-10-31 15:53:27 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:27 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:27 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 15:53:27 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:27 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:27 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 15:53:27 - database - ERROR - Database query error: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists. - Query: 
            INSERT INTO customers (username, password, real_name, currency, status, balance, prefer
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists.
2025-10-31 15:53:27 - routers.customers - ERROR - Error creating customer - Username: duplicate_test, Error: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists.
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/routers/customers.py", line 120, in create_customer
    result = await execute_one(
             ^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists.
2025-10-31 15:53:27 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 409 Conflict"
2025-10-31 15:53:27 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:27 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:27 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 15:53:27 - httpx - INFO - HTTP Request: GET http://test/api/customers/2 "HTTP/1.1 200 OK"
2025-10-31 15:53:27 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:27 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:27 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 15:53:27 - httpx - INFO - HTTP Request: PUT http://test/api/customers/2 "HTTP/1.1 200 OK"
2025-10-31 15:53:27 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:28 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:28 - httpx - INFO - HTTP Request: GET http://test/api/customers?status=active "HTTP/1.1 200 OK"
2025-10-31 15:53:28 - httpx - INFO - HTTP Request: GET http://test/api/customers?currency=USD "HTTP/1.1 200 OK"
2025-10-31 15:53:28 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:28 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:28 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 15:53:28 - httpx - INFO - HTTP Request: DELETE http://test/api/customers/2 "HTTP/1.1 204 No Content"
2025-10-31 15:53:28 - httpx - INFO - HTTP Request: GET http://test/api/customers/2 "HTTP/1.1 404 Not Found"
2025-10-31 15:53:28 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:28 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:28 - httpx - INFO - HTTP Request: GET http://test/api/events "HTTP/1.1 200 OK"
2025-10-31 15:53:28 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:28 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:28 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:53:28 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:53:28 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:53:28 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:28 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:28 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:53:28 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:53:28 - main - WARNING - Validation error: body: Team A and Team B must be different - Path: /api/events - Method: POST
2025-10-31 15:53:28 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 422 Unprocessable Entity"
2025-10-31 15:53:28 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:29 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:29 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:53:29 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:53:29 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:53:29 - httpx - INFO - HTTP Request: GET http://test/api/events/1 "HTTP/1.1 200 OK"
2025-10-31 15:53:29 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:29 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:29 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:53:29 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:53:29 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:53:29 - httpx - INFO - HTTP Request: PUT http://test/api/events/1 "HTTP/1.1 200 OK"
2025-10-31 15:53:29 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:29 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:29 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:53:29 - httpx - INFO - HTTP Request: GET http://test/api/competitions "HTTP/1.1 200 OK"
2025-10-31 15:53:29 - httpx - INFO - HTTP Request: POST http://test/api/events "HTTP/1.1 201 Created"
2025-10-31 15:53:29 - httpx - INFO - HTTP Request: DELETE http://test/api/events/1 "HTTP/1.1 204 No Content"
2025-10-31 15:53:29 - httpx - INFO - HTTP Request: GET http://test/api/events/1 "HTTP/1.1 404 Not Found"
2025-10-31 15:53:29 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:29 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:29 - httpx - INFO - HTTP Request: GET http://test/ "HTTP/1.1 200 OK"
2025-10-31 15:53:29 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:29 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:29 - httpx - INFO - HTTP Request: GET http://test/health "HTTP/1.1 200 OK"
2025-10-31 15:53:29 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:30 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:30 - httpx - INFO - HTTP Request: GET http://test/api/sports "HTTP/1.1 200 OK"
2025-10-31 15:53:30 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:30 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:30 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 15:53:30 - httpx - INFO - HTTP Request: GET http://test/api/sports/Tennis "HTTP/1.1 200 OK"
2025-10-31 15:53:30 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:30 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:30 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 15:53:30 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:30 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:30 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 15:53:30 - database - ERROR - Database insert error: duplicate key value violates unique constraint "sports_pkey"
DETAIL:  Key (name)=(Rugby) already exists. - Query: INSERT INTO sports (name) VALUES ($1) RETURNING name
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 121, in execute_insert
    result = await conn.fetchval(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 715, in fetchval
    data = await self._execute(query, args, 1, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "sports_pkey"
DETAIL:  Key (name)=(Rugby) already exists.
2025-10-31 15:53:30 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 409 Conflict"
2025-10-31 15:53:30 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:30 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:30 - httpx - INFO - HTTP Request: POST http://test/api/sports "HTTP/1.1 201 Created"
2025-10-31 15:53:30 - httpx - INFO - HTTP Request: DELETE http://test/api/sports/Cricket "HTTP/1.1 204 No Content"
2025-10-31 15:53:30 - httpx - INFO - HTTP Request: GET http://test/api/sports/Cricket "HTTP/1.1 404 Not Found"
2025-10-31 15:53:30 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:31 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:31 - httpx - INFO - HTTP Request: DELETE http://test/api/sports/NonexistentSport "HTTP/1.1 404 Not Found"
2025-10-31 15:53:31 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:31 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:31 - httpx - INFO - HTTP Request: GET http://test/api/sports/NonexistentSport "HTTP/1.1 404 Not Found"
2025-10-31 15:53:31 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:31 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:31 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 15:53:31 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:31 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:31 - httpx - INFO - HTTP Request: GET http://test/api/teams?sport=Football "HTTP/1.1 200 OK"
2025-10-31 15:53:31 - httpx - INFO - HTTP Request: GET http://test/api/teams?country=USA "HTTP/1.1 200 OK"
2025-10-31 15:53:31 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:31 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:31 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 15:53:32 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:32 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:32 - database - ERROR - Database query error: insert or update on table "teams" violates foreign key constraint "teams_sport_fkey"
DETAIL:  Key (sport)=(InvalidSport) is not present in table "sports". - Query: 
            INSERT INTO teams (name, country, sport)
            VALUES ($1, $2, $3)
            RE
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: insert or update on table "teams" violates foreign key constraint "teams_sport_fkey"
DETAIL:  Key (sport)=(InvalidSport) is not present in table "sports".
2025-10-31 15:53:32 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 400 Bad Request"
2025-10-31 15:53:32 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:32 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:32 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 15:53:32 - httpx - INFO - HTTP Request: GET http://test/api/teams/3 "HTTP/1.1 200 OK"
2025-10-31 15:53:32 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:32 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:32 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 15:53:32 - httpx - INFO - HTTP Request: PUT http://test/api/teams/3 "HTTP/1.1 200 OK"
2025-10-31 15:53:32 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 15:53:32 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:32 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 15:53:32 - httpx - INFO - HTTP Request: DELETE http://test/api/teams/3 "HTTP/1.1 204 No Content"
2025-10-31 15:53:32 - httpx - INFO - HTTP Request: GET http://test/api/teams/3 "HTTP/1.1 404 Not Found"
2025-10-31 15:53:55 - main - INFO - Shutting down...
2025-10-31 15:53:55 - main - INFO - Database connection pool closed successfully
2025-10-31 15:53:56 - root - INFO - Logging configured - Level: INFO
2025-10-31 15:53:56 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 15:53:56 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 15:53:56 - database - INFO - Database connection pool created successfully
2025-10-31 15:53:56 - main - INFO - Database connection pool created successfully
2025-10-31 16:01:13 - main - INFO - Shutting down...
2025-10-31 16:01:13 - main - INFO - Database connection pool closed successfully
2025-10-31 16:01:14 - root - INFO - Logging configured - Level: INFO
2025-10-31 16:01:14 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 16:01:14 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 16:01:14 - database - INFO - Database connection pool created successfully
2025-10-31 16:01:14 - main - INFO - Database connection pool created successfully
2025-10-31 16:03:49 - database - ERROR - Database update/delete error: update or delete on table "sports" violates foreign key constraint "competitions_sport_fkey" on table "competitions"
DETAIL:  Key (name)=(Cricket) is still referenced from table "competitions". - Query: DELETE FROM sports WHERE name = $1
Traceback (most recent call last):
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "sports" violates foreign key constraint "competitions_sport_fkey" on table "competitions"
DETAIL:  Key (name)=(Cricket) is still referenced from table "competitions".
2025-10-31 16:03:49 - main - ERROR - Unhandled exception: update or delete on table "sports" violates foreign key constraint "competitions_sport_fkey" on table "competitions"
DETAIL:  Key (name)=(Cricket) is still referenced from table "competitions". - Path: /api/sports/Cricket - Method: DELETE
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/sports.py", line 54, in delete_sport
    affected = await execute_update(query, name)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "sports" violates foreign key constraint "competitions_sport_fkey" on table "competitions"
DETAIL:  Key (name)=(Cricket) is still referenced from table "competitions".
2025-10-31 16:03:50 - database - ERROR - Database update/delete error: update or delete on table "sports" violates foreign key constraint "competitions_sport_fkey" on table "competitions"
DETAIL:  Key (name)=(Cricket) is still referenced from table "competitions". - Query: DELETE FROM sports WHERE name = $1
Traceback (most recent call last):
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "sports" violates foreign key constraint "competitions_sport_fkey" on table "competitions"
DETAIL:  Key (name)=(Cricket) is still referenced from table "competitions".
2025-10-31 16:03:50 - main - ERROR - Unhandled exception: update or delete on table "sports" violates foreign key constraint "competitions_sport_fkey" on table "competitions"
DETAIL:  Key (name)=(Cricket) is still referenced from table "competitions". - Path: /api/sports/Cricket - Method: DELETE
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/sports.py", line 54, in delete_sport
    affected = await execute_update(query, name)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "sports" violates foreign key constraint "competitions_sport_fkey" on table "competitions"
DETAIL:  Key (name)=(Cricket) is still referenced from table "competitions".
2025-10-31 16:03:57 - database - ERROR - Database update/delete error: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets". - Query: DELETE FROM events WHERE id = $1
Traceback (most recent call last):
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets".
2025-10-31 16:03:57 - main - ERROR - Unhandled exception: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets". - Path: /api/events/5 - Method: DELETE
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/events.py", line 170, in delete_event
    affected = await execute_update(query, event_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "events" violates foreign key constraint "bets_event_id_fkey" on table "bets"
DETAIL:  Key (id)=(5) is still referenced from table "bets".
2025-10-31 16:04:07 - database - ERROR - Database update/delete error: update or delete on table "customers" violates foreign key constraint "balance_changes_customer_id_fkey" on table "balance_changes"
DETAIL:  Key (id)=(3) is still referenced from table "balance_changes". - Query: DELETE FROM customers WHERE id = $1
Traceback (most recent call last):
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "customers" violates foreign key constraint "balance_changes_customer_id_fkey" on table "balance_changes"
DETAIL:  Key (id)=(3) is still referenced from table "balance_changes".
2025-10-31 16:04:07 - main - ERROR - Unhandled exception: update or delete on table "customers" violates foreign key constraint "balance_changes_customer_id_fkey" on table "balance_changes"
DETAIL:  Key (id)=(3) is still referenced from table "balance_changes". - Path: /api/customers/3 - Method: DELETE
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/customers.py", line 258, in delete_customer
    affected = await execute_update(query, customer_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "customers" violates foreign key constraint "balance_changes_customer_id_fkey" on table "balance_changes"
DETAIL:  Key (id)=(3) is still referenced from table "balance_changes".
2025-10-31 16:05:46 - main - INFO - Shutting down...
2025-10-31 16:05:46 - main - INFO - Database connection pool closed successfully
ion pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 16:05:21 - database - INFO - Database connection pool created successfully
2025-10-31 16:05:21 - httpx - INFO - HTTP Request: GET http://test/api/customers "HTTP/1.1 200 OK"
2025-10-31 16:05:21 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 16:05:21 - database - INFO - Database connection pool created successfully
2025-10-31 16:05:21 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 16:05:22 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 16:05:22 - database - INFO - Database connection pool created successfully
2025-10-31 16:05:22 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 16:05:22 - database - ERROR - Database query error: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists. - Query: 
            INSERT INTO customers (username, password, real_name, currency, status, balance, prefer
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists.
2025-10-31 16:05:22 - routers.customers - ERROR - Error creating customer - Username: duplicate_test, Error: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists.
Traceback (most recent call last):
  File "/Users/himu/Downloads/fs-take-home/backend/routers/customers.py", line 120, in create_customer
    result = await execute_one(
             ^^^^^^^^^^^^^^^^^^
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 90, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 109, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.UniqueViolationError: duplicate key value violates unique constraint "customers_username_key"
DETAIL:  Key (username)=(duplicate_test) already exists.
2025-10-31 16:05:22 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 409 Conflict"
2025-10-31 16:05:22 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 16:05:22 - database - INFO - Database connection pool created successfully
2025-10-31 16:05:22 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 16:05:22 - httpx - INFO - HTTP Request: GET http://test/api/customers/2 "HTTP/1.1 200 OK"
2025-10-31 16:05:22 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 16:05:22 - database - INFO - Database connection pool created successfully
2025-10-31 16:05:22 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 16:05:22 - httpx - INFO - HTTP Request: PUT http://test/api/customers/2 "HTTP/1.1 200 OK"
2025-10-31 16:05:22 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 16:05:22 - database - INFO - Database connection pool created successfully
2025-10-31 16:05:22 - httpx - INFO - HTTP Request: GET http://test/api/customers?status=active "HTTP/1.1 200 OK"
2025-10-31 16:05:22 - httpx - INFO - HTTP Request: GET http://test/api/customers?currency=USD "HTTP/1.1 200 OK"
2025-10-31 16:05:22 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 16:05:23 - database - INFO - Database connection pool created successfully
2025-10-31 16:05:23 - httpx - INFO - HTTP Request: POST http://test/api/customers "HTTP/1.1 201 Created"
2025-10-31 16:05:23 - httpx - INFO - HTTP Request: DELETE http://test/api/customers/2 "HTTP/1.1 204 No Content"
2025-10-31 16:05:23 - httpx - INFO - HTTP Request: GET http://test/api/customers/2 "HTTP/1.1 404 Not Found"
2025-10-31 16:05:46 - root - INFO - Logging configured - Level: INFO
2025-10-31 16:05:46 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 16:05:46 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 16:05:46 - database - INFO - Database connection pool created successfully
2025-10-31 16:05:46 - main - INFO - Database connection pool created successfully
2025-10-31 16:05:51 - database - ERROR - Database update/delete error: update or delete on table "customers" violates foreign key constraint "balance_changes_customer_id_fkey" on table "balance_changes"
DETAIL:  Key (id)=(3) is still referenced from table "balance_changes". - Query: DELETE FROM customers WHERE id = $1
Traceback (most recent call last):
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "customers" violates foreign key constraint "balance_changes_customer_id_fkey" on table "balance_changes"
DETAIL:  Key (id)=(3) is still referenced from table "balance_changes".
2025-10-31 16:05:51 - main - ERROR - Unhandled exception: update or delete on table "customers" violates foreign key constraint "balance_changes_customer_id_fkey" on table "balance_changes"
DETAIL:  Key (id)=(3) is still referenced from table "balance_changes". - Path: /api/customers/3 - Method: DELETE
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/customers.py", line 258, in delete_customer
    affected = await execute_update(query, customer_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "customers" violates foreign key constraint "balance_changes_customer_id_fkey" on table "balance_changes"
DETAIL:  Key (id)=(3) is still referenced from table "balance_changes".
2025-10-31 16:10:14 - main - INFO - Shutting down...
2025-10-31 16:10:14 - main - INFO - Database connection pool closed successfully
2025-10-31 16:10:16 - root - INFO - Logging configured - Level: INFO
2025-10-31 16:10:16 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 16:10:16 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 16:10:16 - database - INFO - Database connection pool created successfully
2025-10-31 16:10:16 - main - INFO - Database connection pool created successfully
2025-10-31 16:10:30 - main - ERROR - Unhandled exception: 1 validation error for MoneyAmount
amount
  Input should be greater than or equal to 0 [type=greater_than_equal, input_value=Decimal('-75.0000'), input_type=Decimal]
    For further information visit https://errors.pydantic.dev/2.5/v/greater_than_equal - Path: /api/balance-changes - Method: GET
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/balance_changes.py", line 49, in get_balance_changes
    delta = MoneyAmount(amount=row['delta_amount'], currency=row['delta_currency'])
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for MoneyAmount
amount
  Input should be greater than or equal to 0 [type=greater_than_equal, input_value=Decimal('-75.0000'), input_type=Decimal]
    For further information visit https://errors.pydantic.dev/2.5/v/greater_than_equal
2025-10-31 16:11:05 - main - ERROR - Unhandled exception: 1 validation error for MoneyAmount
amount
  Input should be greater than or equal to 0 [type=greater_than_equal, input_value=Decimal('-75.0000'), input_type=Decimal]
    For further information visit https://errors.pydantic.dev/2.5/v/greater_than_equal - Path: /api/balance-changes - Method: GET
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/balance_changes.py", line 49, in get_balance_changes
    delta = MoneyAmount(amount=row['delta_amount'], currency=row['delta_currency'])
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for MoneyAmount
amount
  Input should be greater than or equal to 0 [type=greater_than_equal, input_value=Decimal('-75.0000'), input_type=Decimal]
    For further information visit https://errors.pydantic.dev/2.5/v/greater_than_equal
2025-10-31 16:17:44 - main - INFO - Shutting down...
2025-10-31 16:17:44 - main - INFO - Database connection pool closed successfully
2025-10-31 16:17:44 - root - INFO - Logging configured - Level: INFO
2025-10-31 16:17:44 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 16:17:44 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 16:17:44 - database - INFO - Database connection pool created successfully
2025-10-31 16:17:44 - main - INFO - Database connection pool created successfully
2025-10-31 16:20:11 - main - INFO - Shutting down...
2025-10-31 16:20:11 - main - INFO - Database connection pool closed successfully
2025-10-31 16:20:13 - root - INFO - Logging configured - Level: INFO
2025-10-31 16:20:13 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 16:20:13 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 16:20:13 - database - INFO - Database connection pool created successfully
2025-10-31 16:20:13 - main - INFO - Database connection pool created successfully
2025-10-31 16:20:30 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 16:20:45 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 16:23:42 - main - INFO - Shutting down...
2025-10-31 16:23:42 - main - INFO - Database connection pool closed successfully
2025-10-31 16:23:43 - root - INFO - Logging configured - Level: INFO
2025-10-31 16:23:43 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 16:23:43 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 16:23:43 - database - INFO - Database connection pool created successfully
2025-10-31 16:23:43 - main - INFO - Database connection pool created successfully
2025-10-31 16:24:01 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 16:30:00 - main - INFO - Shutting down...
2025-10-31 16:30:00 - main - INFO - Database connection pool closed successfully
2025-10-31 16:30:02 - root - INFO - Logging configured - Level: INFO
2025-10-31 16:30:02 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 16:30:02 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 16:30:02 - database - INFO - Database connection pool created successfully
2025-10-31 16:30:02 - main - INFO - Database connection pool created successfully
2025-10-31 16:30:17 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 16:30:47 - main - ERROR - Unhandled exception: 1 validation error for MoneyAmount
amount
  Input should be greater than or equal to 0 [type=greater_than_equal, input_value=Decimal('-75.0000'), input_type=Decimal]
    For further information visit https://errors.pydantic.dev/2.5/v/greater_than_equal - Path: /api/balance-changes - Method: GET
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/balance_changes.py", line 49, in get_balance_changes
    delta = MoneyAmount(amount=row['delta_amount'], currency=row['delta_currency'])
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for MoneyAmount
amount
  Input should be greater than or equal to 0 [type=greater_than_equal, input_value=Decimal('-75.0000'), input_type=Decimal]
    For further information visit https://errors.pydantic.dev/2.5/v/greater_than_equal
2025-10-31 16:30:53 - main - ERROR - Unhandled exception: 1 validation error for MoneyAmount
amount
  Input should be greater than or equal to 0 [type=greater_than_equal, input_value=Decimal('-75.0000'), input_type=Decimal]
    For further information visit https://errors.pydantic.dev/2.5/v/greater_than_equal - Path: /api/balance-changes - Method: GET
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/balance_changes.py", line 49, in get_balance_changes
    delta = MoneyAmount(amount=row['delta_amount'], currency=row['delta_currency'])
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/pydantic/main.py", line 164, in __init__
    __pydantic_self__.__pydantic_validator__.validate_python(data, self_instance=__pydantic_self__)
pydantic_core._pydantic_core.ValidationError: 1 validation error for MoneyAmount
amount
  Input should be greater than or equal to 0 [type=greater_than_equal, input_value=Decimal('-75.0000'), input_type=Decimal]
    For further information visit https://errors.pydantic.dev/2.5/v/greater_than_equal
2025-10-31 16:31:26 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 16:31:53 - main - INFO - Shutting down...
2025-10-31 16:31:53 - main - INFO - Database connection pool closed successfully
2025-10-31 16:31:54 - root - INFO - Logging configured - Level: INFO
2025-10-31 16:31:54 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 16:31:54 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 16:31:54 - database - INFO - Database connection pool created successfully
2025-10-31 16:31:54 - main - INFO - Database connection pool created successfully
2025-10-31 16:32:10 - main - INFO - Shutting down...
2025-10-31 16:32:10 - main - INFO - Database connection pool closed successfully
2025-10-31 16:32:10 - root - INFO - Logging configured - Level: INFO
2025-10-31 16:32:10 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 16:32:10 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 16:32:10 - database - INFO - Database connection pool created successfully
2025-10-31 16:32:10 - main - INFO - Database connection pool created successfully
2025-10-31 16:32:17 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 16:33:17 - root - INFO - Logging configured - Level: INFO
2025-10-31 16:33:39 - main - INFO - Shutting down...
2025-10-31 16:33:39 - main - INFO - Database connection pool closed successfully
2025-10-31 16:33:40 - root - INFO - Logging configured - Level: INFO
2025-10-31 16:33:40 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 16:33:40 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 16:33:40 - database - INFO - Database connection pool created successfully
2025-10-31 16:33:40 - main - INFO - Database connection pool created successfully
2025-10-31 16:34:05 - main - INFO - Shutting down...
2025-10-31 16:34:05 - main - INFO - Database connection pool closed successfully
2025-10-31 16:34:32 - root - INFO - Logging configured - Level: INFO
2025-10-31 16:34:32 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 16:34:32 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 16:34:32 - database - INFO - Database connection pool created successfully
2025-10-31 16:34:32 - main - INFO - Database connection pool created successfully
2025-10-31 16:35:05 - main - INFO - Shutting down...
2025-10-31 16:35:05 - main - INFO - Database connection pool closed successfully
2025-10-31 16:35:07 - root - INFO - Logging configured - Level: INFO
2025-10-31 16:35:07 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 16:35:07 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 16:35:07 - database - INFO - Database connection pool created successfully
2025-10-31 16:35:07 - main - INFO - Database connection pool created successfully
2025-10-31 16:35:13 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 16:37:13 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 16:39:58 - main - INFO - Shutting down...
2025-10-31 16:39:58 - main - INFO - Database connection pool closed successfully
2025-10-31 16:40:00 - root - INFO - Logging configured - Level: INFO
2025-10-31 16:40:00 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 16:40:00 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 16:40:00 - database - INFO - Database connection pool created successfully
2025-10-31 16:40:00 - main - INFO - Database connection pool created successfully
2025-10-31 16:41:08 - main - INFO - Shutting down...
2025-10-31 16:41:08 - main - INFO - Database connection pool closed successfully
2025-10-31 16:41:08 - root - INFO - Logging configured - Level: INFO
2025-10-31 16:41:08 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 16:41:08 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 16:41:08 - database - INFO - Database connection pool created successfully
2025-10-31 16:41:08 - main - INFO - Database connection pool created successfully
2025-10-31 16:41:56 - main - INFO - Shutting down...
2025-10-31 16:41:56 - main - INFO - Database connection pool closed successfully
2025-10-31 16:41:56 - root - INFO - Logging configured - Level: INFO
2025-10-31 16:41:56 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 16:41:56 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 16:41:56 - database - INFO - Database connection pool created successfully
2025-10-31 16:41:56 - main - INFO - Database connection pool created successfully
2025-10-31 16:43:28 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 18:30:15 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 18:37:50 - routers.auth - WARNING - Failed login attempt for user: admi
2025-10-31 18:37:58 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 18:41:08 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 18:51:17 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 19:32:58 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 19:33:10 - database - ERROR - Database update/delete error: update or delete on table "competitions" violates foreign key constraint "events_competition_id_fkey" on table "events"
DETAIL:  Key (id)=(3) is still referenced from table "events". - Query: DELETE FROM competitions WHERE id = $1
Traceback (most recent call last):
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "competitions" violates foreign key constraint "events_competition_id_fkey" on table "events"
DETAIL:  Key (id)=(3) is still referenced from table "events".
2025-10-31 19:33:10 - main - ERROR - Unhandled exception: update or delete on table "competitions" violates foreign key constraint "events_competition_id_fkey" on table "events"
DETAIL:  Key (id)=(3) is still referenced from table "events". - Path: /api/competitions/3 - Method: DELETE
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/anyio/streams/memory.py", line 98, in receive
    return self.receive_nowait()
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/anyio/streams/memory.py", line 93, in receive_nowait
    raise WouldBlock
anyio.WouldBlock

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 78, in call_next
    message = await recv_stream.receive()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/anyio/streams/memory.py", line 118, in receive
    raise EndOfStream
anyio.EndOfStream

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 108, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/main.py", line 85, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 84, in call_next
    raise app_exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/base.py", line 70, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 91, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/cors.py", line 146, in simple_response
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 79, in __call__
    raise exc
  File "/usr/local/lib/python3.11/site-packages/starlette/middleware/exceptions.py", line 68, in __call__
    await self.app(scope, receive, sender)
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 20, in __call__
    raise e
  File "/usr/local/lib/python3.11/site-packages/fastapi/middleware/asyncexitstack.py", line 17, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 718, in __call__
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 276, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.11/site-packages/starlette/routing.py", line 66, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 274, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/routers/competitions.py", line 143, in delete_competition
    affected = await execute_update(query, competition_id)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/database.py", line 133, in execute_update
    result = await conn.execute(query, *args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 353, in execute
    _, status, _ = await self._execute(
                   ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: update or delete on table "competitions" violates foreign key constraint "events_competition_id_fkey" on table "events"
DETAIL:  Key (id)=(3) is still referenced from table "events".
2025-10-31 19:44:24 - main - INFO - Shutting down...
2025-10-31 19:44:24 - main - INFO - Database connection pool closed successfully
2025-10-31 19:45:02 - root - INFO - Logging configured - Level: INFO
2025-10-31 19:45:02 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 19:45:02 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 19:45:02 - database - INFO - Database connection pool created successfully
2025-10-31 19:45:02 - main - INFO - Database connection pool created successfully
2025-10-31 19:45:11 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 19:50:39 - main - INFO - Shutting down...
2025-10-31 19:50:39 - main - INFO - Database connection pool closed successfully
2025-10-31 19:51:07 - root - INFO - Logging configured - Level: INFO
2025-10-31 19:51:07 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 19:51:07 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 19:51:07 - database - INFO - Database connection pool created successfully
2025-10-31 19:51:07 - main - INFO - Database connection pool created successfully
2025-10-31 19:52:06 - main - INFO - Shutting down...
2025-10-31 19:52:06 - main - INFO - Database connection pool closed successfully
2025-10-31 19:57:01 - root - INFO - Logging configured - Level: INFO
2025-10-31 19:58:54 - root - INFO - Logging configured - Level: INFO
2025-10-31 19:59:19 - root - INFO - Logging configured - Level: INFO
2025-10-31 19:59:19 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 19:59:19 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 19:59:19 - database - INFO - Database connection pool created successfully
2025-10-31 19:59:19 - main - INFO - Database connection pool created successfully
2025-10-31 20:08:25 - main - INFO - Shutting down...
2025-10-31 20:08:25 - main - INFO - Database connection pool closed successfully
ion pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 19:59:22 - database - INFO - Database connection pool created successfully
2025-10-31 19:59:22 - httpx - INFO - HTTP Request: GET http://test/api/teams "HTTP/1.1 200 OK"
2025-10-31 19:59:22 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 19:59:22 - database - INFO - Database connection pool created successfully
2025-10-31 19:59:22 - httpx - INFO - HTTP Request: GET http://test/api/teams?sport=Football "HTTP/1.1 200 OK"
2025-10-31 19:59:22 - httpx - INFO - HTTP Request: GET http://test/api/teams?country=USA "HTTP/1.1 200 OK"
2025-10-31 19:59:22 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 19:59:22 - database - INFO - Database connection pool created successfully
2025-10-31 19:59:22 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 19:59:22 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 19:59:22 - database - INFO - Database connection pool created successfully
2025-10-31 19:59:22 - database - ERROR - Database query error: insert or update on table "teams" violates foreign key constraint "teams_sport_fkey"
DETAIL:  Key (sport)=(InvalidSport) is not present in table "sports". - Query: 
            INSERT INTO teams (name, country, sport)
            VALUES ($1, $2, $3)
            RE
Traceback (most recent call last):
  File "/Users/himu/.pyenv/versions/3.11.0/lib/python3.11/contextlib.py", line 222, in __aexit__
    await self.gen.athrow(typ, value, traceback)
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 83, in get_db_connection
    yield connection
  File "/Users/himu/Downloads/fs-take-home/backend/database.py", line 100, in execute_one
    row = await conn.fetchrow(query, *args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 749, in fetchrow
    data = await self._execute(
           ^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1794, in _execute
    result, _ = await self.__execute(
                ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1892, in __execute
    result, stmt = await self._do_execute(
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/himu/Downloads/fs-take-home/backend/venv/lib/python3.11/site-packages/asyncpg/connection.py", line 1948, in _do_execute
    result = await executor(stmt, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "asyncpg/protocol/protocol.pyx", line 207, in bind_execute
asyncpg.exceptions.ForeignKeyViolationError: insert or update on table "teams" violates foreign key constraint "teams_sport_fkey"
DETAIL:  Key (sport)=(InvalidSport) is not present in table "sports".
2025-10-31 19:59:22 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 400 Bad Request"
2025-10-31 19:59:23 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 19:59:23 - database - INFO - Database connection pool created successfully
2025-10-31 19:59:23 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 19:59:23 - httpx - INFO - HTTP Request: GET http://test/api/teams/3 "HTTP/1.1 200 OK"
2025-10-31 19:59:23 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 19:59:23 - database - INFO - Database connection pool created successfully
2025-10-31 19:59:23 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 19:59:23 - httpx - INFO - HTTP Request: PUT http://test/api/teams/3 "HTTP/1.1 200 OK"
2025-10-31 19:59:23 - database - INFO - Creating database connection pool - Host: localhost, Port: 5432, Database: analyst_platform_test
2025-10-31 19:59:23 - database - INFO - Database connection pool created successfully
2025-10-31 19:59:23 - httpx - INFO - HTTP Request: POST http://test/api/teams "HTTP/1.1 201 Created"
2025-10-31 19:59:23 - httpx - INFO - HTTP Request: DELETE http://test/api/teams/3 "HTTP/1.1 204 No Content"
2025-10-31 19:59:23 - httpx - INFO - HTTP Request: GET http://test/api/teams/3 "HTTP/1.1 404 Not Found"
2025-10-31 20:08:58 - root - INFO - Logging configured - Level: INFO
2025-10-31 20:08:58 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 20:08:58 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 20:08:58 - database - INFO - Database connection pool created successfully
2025-10-31 20:08:58 - main - INFO - Database connection pool created successfully
2025-10-31 20:09:02 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 20:09:26 - main - INFO - Shutting down...
2025-10-31 20:09:26 - main - INFO - Database connection pool closed successfully
2025-10-31 20:17:01 - root - INFO - Logging configured - Level: INFO
2025-10-31 20:17:01 - main - INFO - Starting up Sports Betting Admin Platform API...
2025-10-31 20:17:01 - database - INFO - Creating database connection pool - Host: postgres, Port: 5432, Database: analyst_platform
2025-10-31 20:17:01 - database - INFO - Database connection pool created successfully
2025-10-31 20:17:01 - main - INFO - Database connection pool created successfully
2025-10-31 20:17:06 - routers.auth - INFO - Successful login attempt for user: admin
2025-10-31 20:17:28 - main - INFO - Shutting down...
2025-10-31 20:17:28 - main - INFO - Database connection pool closed successfully
